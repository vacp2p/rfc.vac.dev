<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-vac docs-doc-id-raw/eth-secpm">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">ETH-SECPM | Vac Research</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://vac.dev/vac/raw/eth-secpm"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="image" content="https://vac.dev/_og/b5764aa7ff8fd58268484117c7b825d8f3ce1a7d.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-vac-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-vac-current"><meta data-rh="true" property="og:title" content="ETH-SECPM | Vac Research"><meta data-rh="true" name="description" content="- Status: raw"><meta data-rh="true" property="og:description" content="- Status: raw"><link data-rh="true" rel="icon" href="/theme/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://vac.dev/vac/raw/eth-secpm"><link data-rh="true" rel="alternate" href="https://vac.dev/vac/raw/eth-secpm" hreflang="en"><link data-rh="true" rel="alternate" href="https://vac.dev/vac/raw/eth-secpm" hreflang="x-default"><link rel="alternate icon" type="image/png" href="/theme/image/favicon.png">
<link rel="icon" type="image/svg+xml" href="/theme/image/favicon.svg"><link rel="stylesheet" href="/assets/css/styles.714f64f3.css">
<link rel="preload" href="/assets/js/runtime~main.3dffa60e.js" as="script">
<link rel="preload" href="/assets/js/main.ecc006a1.js" as="script">
<meta property="og:image" content="https://vac.dev/_og/b5764aa7ff8fd58268484117c7b825d8f3ce1a7d.png"><meta name="twitter:image" content="https://vac.dev/_og/b5764aa7ff8fd58268484117c7b825d8f3ce1a7d.png"></head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<style data-emotion="css-global 3rtehh">.lsd-button{width:auto;cursor:pointer;padding:6px 24px;}.lsd-button--disabled{cursor:default;opacity:0.34;}.lsd-button--large{padding:10px 40px;}.lsd-button--medium{padding:6px 24px;}.lsd-button--small{padding:6px 12px;}.lsd-button:hover:not(.lsd-button--disabled) .lsd-button__text{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-button--with-icon{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-button__icon{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;}.lsd-button--large.lsd-button--with-icon{padding:10px 0px 10px 18px;}.lsd-button--large.lsd-button--with-icon .lsd-button__icon{width:42px;}.lsd-button--medium.lsd-button--with-icon{padding:6px 0px 6px 14px;}.lsd-button--medium.lsd-button--with-icon .lsd-button__icon{width:38px;}.lsd-button--small.lsd-button--with-icon{padding:6px 0px 6px 12px;}.lsd-button--small.lsd-button--with-icon .lsd-button__icon{width:34px;}.lsd-button--outlined{background:none;border:1px solid rgb(var(--lsd-border-primary));}.lsd-button--outlined .lsd-button__text{color:rgb(var(--lsd-text-primary));}.lsd-button--filled{background:rgb(var(--lsd-surface-secondary));border:1px solid rgb(var(--lsd-border-primary));}.lsd-button--filled .lsd-button__text{color:rgb(var(--lsd-text-secondary));}</style><style data-emotion="css-global 10bahxd">.lsd-icon-button{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;cursor:pointer;background:none;padding:0;border:1px solid rgb(var(--lsd-border-primary));}.lsd-icon-button--filled{background-color:rgb(var(--lsd-icon-primary));}.lsd-icon-button--filled svg{--lsd-icon-primary:var(--lsd-icon-secondary);}.lsd-icon-button--disabled{opacity:0.34;cursor:default;}.lsd-icon-button--large{width:40px;height:40px;}.lsd-icon-button--medium{width:32px;height:32px;}.lsd-icon-button--small{width:28px;height:28px;}</style><style data-emotion="css-global icqph9">.lsd-icon-button-group{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.lsd-icon-button-group--outlined .lsd-icon-button:not(:last-child){border-right:none;}</style><style data-emotion="css-global 1f43ub2">body *{font-family:var(--lsd-typography-generic-font-family);}.lsd-typography{color:rgb(var(--lsd-text-primary));}.lsd-typography--sans-serif,.lsd-typography--sans-serif *{font-family:sans-serif;}.lsd-typography--serif,.lsd-typography--serif *{font-family:serif;}.lsd-typography--monospace,.lsd-typography--monospace *{font-family:monospace;}.lsd-typography--display1{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-display1-fontWeight);font-size:var(--lsd-display1-fontSize);line-height:var(--lsd-display1-lineHeight);}.lsd-typography--display2{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-display2-fontWeight);font-size:var(--lsd-display2-fontSize);line-height:var(--lsd-display2-lineHeight);}.lsd-typography--display3{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-display3-fontWeight);font-size:var(--lsd-display3-fontSize);line-height:var(--lsd-display3-lineHeight);}.lsd-typography--display4{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-display4-fontWeight);font-size:var(--lsd-display4-fontSize);line-height:var(--lsd-display4-lineHeight);}h1,.lsd-typography--h1{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-h1-fontWeight);font-size:var(--lsd-h1-fontSize);line-height:var(--lsd-h1-lineHeight);}h2,.lsd-typography--h2{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-h2-fontWeight);font-size:var(--lsd-h2-fontSize);line-height:var(--lsd-h2-lineHeight);}h3,.lsd-typography--h3{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-h3-fontWeight);font-size:var(--lsd-h3-fontSize);line-height:var(--lsd-h3-lineHeight);}h4,.lsd-typography--h4{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-h4-fontWeight);font-size:var(--lsd-h4-fontSize);line-height:var(--lsd-h4-lineHeight);}h5,.lsd-typography--h5{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-h5-fontWeight);font-size:var(--lsd-h5-fontSize);line-height:var(--lsd-h5-lineHeight);}h6,.lsd-typography--h6{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-h6-fontWeight);font-size:var(--lsd-h6-fontSize);line-height:var(--lsd-h6-lineHeight);}.lsd-typography--subtitle1{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-subtitle1-fontWeight);font-size:var(--lsd-subtitle1-fontSize);line-height:var(--lsd-subtitle1-lineHeight);}.lsd-typography--subtitle2{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-subtitle2-fontWeight);font-size:var(--lsd-subtitle2-fontSize);line-height:var(--lsd-subtitle2-lineHeight);}.lsd-typography--subtitle3{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-subtitle3-fontWeight);font-size:var(--lsd-subtitle3-fontSize);line-height:var(--lsd-subtitle3-lineHeight);}.lsd-typography--subtitle4{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-subtitle4-fontWeight);font-size:var(--lsd-subtitle4-fontSize);line-height:var(--lsd-subtitle4-lineHeight);}body,.lsd-typography--body1{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-body1-fontWeight);font-size:var(--lsd-body1-fontSize);line-height:var(--lsd-body1-lineHeight);}.lsd-typography--body2{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-body2-fontWeight);font-size:var(--lsd-body2-fontSize);line-height:var(--lsd-body2-lineHeight);}.lsd-typography--body3{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-body3-fontWeight);font-size:var(--lsd-body3-fontSize);line-height:var(--lsd-body3-lineHeight);}label,.lsd-typography--label1{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-label1-fontWeight);font-size:var(--lsd-label1-fontSize);line-height:var(--lsd-label1-lineHeight);}.lsd-typography--label2{color:rgb(var(--lsd-text-primary));font-weight:var(--lsd-label2-fontWeight);font-size:var(--lsd-label2-fontSize);line-height:var(--lsd-label2-lineHeight);}.lsd-typography--primary{color:rgb(var(--lsd-text-primary));}.lsd-typography--secondary{color:rgb(var(--lsd-text-secondary));}input{color:rgb(var(--lsd-text-primary));font-size:var(--lsd-body1-fontSize);font-weight:var(--lsd-body1-fontWeight);}h1,h2,h3,h4,h5,h6,p,span{margin:0;}</style><style data-emotion="css-global 1yxb6i5">.lsd-icon--primary.lsd-icon--filled,.lsd-icon--primary.lsd-icon--filled *{fill:rgb(var(--lsd-icon-primary));}.lsd-icon--primary $.lsd-icon--stroked,.lsd-icon--primary $.lsd-icon--stroked *{fill:rgb(var(--lsd-icon-primary));}.lsd-icon--secondary.lsd-icon--filled,.lsd-icon--secondary.lsd-icon--filled *{fill:rgb(var(--lsd-icon-secondary));}.lsd-icon--secondary $.lsd-icon--stroked,.lsd-icon--secondary $.lsd-icon--stroked *{fill:rgb(var(--lsd-icon-secondary));}</style><style data-emotion="css-global 1hozxbf">.lsd-tab-item{background:rgb(var(--lsd-surface-primary));border:1px solid transparent;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;box-sizing:border-box;}.lsd-tab-item:hover{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-tab-item:not(lsd-tab-item--selected){border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-tab-item--text{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}.lsd-tab-item--icon{margin-left:14px;}.lsd-tab-item--selected{border:1px solid rgb(var(--lsd-border-primary));}.lsd-tab-item--selected:hover{-webkit-text-decoration:none;text-decoration:none;}.lsd-tab-item--with-icon{-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.lsd-tab-item--disabled{cursor:default;opacity:0.34;}.lsd-tab-item--disabled:hover{-webkit-text-decoration:none;text-decoration:none;}.lsd-tab-item--small{padding:6px 12px;}.lsd-tab-item--small .lsd-tab-item--icon{margin-left:10px;}.lsd-tab-item--medium{padding:6px 14px;}.lsd-tab-item--medium .lsd-tab-item--icon{margin-left:12px;}.lsd-tab-item--large{padding:10px 18px;}.lsd-tab-item--large .lsd-tab-item--icon{margin-left:14px;}</style><style data-emotion="css-global 1a24j7d">.lsd-tabs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;overflow:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;max-width:100%;border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-tabs>*{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.lsd-tabs .lsd-tab-item{border-bottom:none;}.lsd-tabs--full-width{width:100%;-webkit-box-pack:stretch;-ms-flex-pack:stretch;-webkit-justify-content:stretch;justify-content:stretch;}.lsd-tabs--full-width>*{width:100%;-webkit-flex:1 0;-ms-flex:1 0;flex:1 0;}.lsd-tabs{-ms-overflow-style:none;scrollbar-width:none;}.lsd-tabs::-webkit-scrollbar{display:none;}.lsd-tabs__left-scroll-control{left:0;}.lsd-tabs__right-scroll-control{right:0;}.lsd-tabs__right-scroll-control,.lsd-tabs__left-scroll-control{top:0;-webkit-flex:0 1;-ms-flex:0 1;flex:0 1;position:-webkit-sticky;position:sticky;}</style><style data-emotion="css-global 1v7gjjb">.lsd-dropdown-menu{position:absolute;top:0;left:0;opacity:0;visibility:hidden;margin:0;padding:0;box-sizing:border-box;background:rgb(var(--lsd-surface-primary));overflow:auto;border:1px solid rgb(var(--lsd-border-primary));border-top:0;}.lsd-dropdown-menu>div{border:0;}.lsd-dropdown-menu>div:not(:last-child){border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-dropdown-menu--open{opacity:1;visibility:visible;}.lsd-dropdown-menu--large{max-height:220px;}.lsd-dropdown-menu--medium{max-height:176px;}.lsd-dropdown-menu--small{max-height:154px;}</style><style data-emotion="css-global hyd3xb">.lsd-dropdown:not(.lsd-dropdown--disabled):not(
      .lsd-dropdown--error
    ) .lsd-dropdown__trigger:hover .lsd-dropdown__option-label,.lsd-dropdown:not(.lsd-dropdown--disabled):not(
      .lsd-dropdown--error
    ) .lsd-dropdown__trigger:focus .lsd-dropdown__option-label{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-dropdown__label{display:block;}.lsd-dropdown__button-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.lsd-dropdown__trigger{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;border:none;cursor:pointer;background:none;}.lsd-dropdown__trigger:focus{outline:none;}.lsd-dropdown__option-label{cursor:inherit;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.lsd-dropdown__icons{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;gap:8px;}.lsd-dropdown__icon{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-dropdown__supporting-text{margin:6px 14px;}.lsd-dropdown--error .lsd-dropdown__option-label{-webkit-text-decoration:line-through;text-decoration:line-through;}.lsd-dropdown--disabled{opacity:0.34;cursor:initial;}.lsd-dropdown--large{width:208px;}.lsd-dropdown--large.lsd-dropdown--error{width:230px;}.lsd-dropdown--large .lsd-dropdown__label{margin:0 0 6px 18px;}.lsd-dropdown--large .lsd-dropdown__button-container{height:40px;}.lsd-dropdown--large .lsd-dropdown__trigger{padding:10px 0px 10px 18px;}.lsd-dropdown--large .lsd-dropdown__icons{padding:0px 14px;}.lsd-dropdown--medium{width:188px;}.lsd-dropdown--medium.lsd-dropdown--error{width:210px;}.lsd-dropdown--medium .lsd-dropdown__label{margin:0 0 6px 14px;}.lsd-dropdown--medium .lsd-dropdown__button-container{height:32px;}.lsd-dropdown--medium .lsd-dropdown__trigger{padding:6px 0px 6px 14px;}.lsd-dropdown--medium .lsd-dropdown__icons{padding:0px 12px;}.lsd-dropdown--small{width:164px;}.lsd-dropdown--small.lsd-dropdown--error{width:186px;}.lsd-dropdown--small .lsd-dropdown__label{margin:0 0 6px 12px;}.lsd-dropdown--small .lsd-dropdown__button-container{height:28px;}.lsd-dropdown--small .lsd-dropdown__trigger{padding:6px 0px 6px 12px;}.lsd-dropdown--small .lsd-dropdown__icons{padding:0px 10px;}.lsd-dropdown--outlined .lsd-dropdown__button-container{border:1px solid rgb(var(--lsd-border-primary));}.lsd-dropdown--underlined .lsd-dropdown__button-container{border:1px solid transparent;border-bottom:1px solid rgb(var(--lsd-border-primary));}</style><style data-emotion="css-global w2g5fy">.lsd-dropdown-item{width:100%;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:1px solid rgb(var(--lsd-border-primary));}.lsd-dropdown-item:not(.lsd-dropdown-item--disabled){cursor:pointer;}.lsd-dropdown-item:not(.lsd-dropdown-item--disabled):hover,.lsd-dropdown-item:not(.lsd-dropdown-item--disabled):focus{outline:none;}.lsd-dropdown-item:not(.lsd-dropdown-item--disabled):hover .lsd-dropdown-item__label,.lsd-dropdown-item:not(.lsd-dropdown-item--disabled):focus .lsd-dropdown-item__label{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-dropdown-item__label{display:block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}.lsd-dropdown-item--disabled{opacity:0.34;}.lsd-dropdown-item__icon{margin-right:18px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.lsd-dropdown-item--small{padding:5px 9px;height:28px;}.lsd-dropdown-item--medium{padding:5px 11px;height:32px;}.lsd-dropdown-item--large{padding:5px 13px;height:40px;}</style><style data-emotion="css-global ww9kgc">.lsd-breadcrumb__list{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;list-style-type:none;margin:0;padding:0;}.lsd-breadcrumb--disabled .lsd-breadcrumb__list{opacity:0.34;cursor:initial;pointer-events:none;}.lsd-breadcrumb__dropdown-menu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;overflow:auto;border:1px solid rgb(var(--lsd-border-primary));margin-top:10px;position:absolute;width:auto!important;}.lsd-breadcrumb__dropdown-menu>li{cursor:pointer;}.lsd-breadcrumb__dropdown-menu>li:not(:last-child){border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-breadcrumb__dropdown-menu>li:hover,.lsd-breadcrumb__dropdown-menu>li:focus{-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgb(var(--lsd-border-primary));}.lsd-breadcrumb__dropdown-menu li>a{width:164px;padding:5px 11px;}</style><style data-emotion="css-global 4gvini">.lsd-breadcrumb-item{list-style-type:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-breadcrumb__list>li:not(:last-child)::after{display:inline-block;margin-inline:12px;content:'/';}.lsd-breadcrumb-item__link{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;}.lsd-breadcrumb-item--outlined{padding:3px 11px;border:1px solid rgb(var(--lsd-border-primary));}.lsd-breadcrumb:not(.lsd-breadcrumb--disabled) .lsd-breadcrumb-item__link:hover,.lsd-breadcrumb:not(.lsd-breadcrumb--disabled) .lsd-breadcrumb-item__link:focus{-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgb(var(--lsd-border-primary));}</style><style data-emotion="css-global 1cwg3oc">.lsd-card{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.lsd-card>.lsd-card-header{margin-bottom:-1px;}</style><style data-emotion="css-global v7d76i">.lsd-card-header{box-sizing:border-box;padding:10px 18px;text-align:center;border:1px solid rgb(var(--lsd-border-primary));}.lsd-card-header__title{overflow:hidden;word-break:break-all;}.lsd-card-header--large{padding:10px 18px;}.lsd-card-header--medium{padding:6px 14px;}.lsd-card-header--small{padding:6px 12px;}</style><style data-emotion="css-global 1txgafh">.lsd-card-body{box-sizing:border-box;padding:14px 22px;border:1px solid rgb(var(--lsd-border-primary));}</style><style data-emotion="css-global kzy52c">.lsd-tag{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;box-sizing:border-box;border:1px solid rgb(var(--lsd-icon-primary));}.lsd-tag:hover,.lsd-tag:focus{-webkit-text-decoration:underline;text-decoration:underline;cursor:pointer;}.lsd-badge--large{padding:3px 11px;gap:12px;height:28px;}.lsd-badge--small{padding:3px 7px;gap:8px;height:24px;}.lsd-tag--filled{background-color:rgb(var(--lsd-icon-primary));}.lsd-tag--filled .lsd-tag__label{color:rgb(var(--lsd-text-secondary));}.lsd-tag--filled svg{--lsd-icon-primary:var(--lsd-icon-secondary);}.lsd-tag--outlined{color:rgb(var(--lsd-text-primary));}.lsd-tag--disabled{opacity:0.3;cursor:initial;pointer-events:none;}</style><style data-emotion="css-global 4wy0ub">.lsd-text-field{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.lsd-text-field__input-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.lsd-text-field--disabled{opacity:0.34;}.lsd-text-field__input{border:none;outline:none;font-size:14px;color:rgb(var(--lsd-text-primary));background:none;width:100%;}.lsd-text-field__input:hover{outline:none;}.lsd-text-field__input::-webkit-input-placeholder{color:rgb(var(--lsd-text-primary));opacity:0.3;}.lsd-text-field__input::-moz-placeholder{color:rgb(var(--lsd-text-primary));opacity:0.3;}.lsd-text-field__input:-ms-input-placeholder{color:rgb(var(--lsd-text-primary));opacity:0.3;}.lsd-text-field__input::placeholder{color:rgb(var(--lsd-text-primary));opacity:0.3;}.lsd-text-field--error .lsd-text-field__input{-webkit-text-decoration:line-through;text-decoration:line-through;}.lsd-text-field__supporting-text{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;}.lsd-text-field--large{width:208px;}.lsd-text-field--large>*{padding:10px 14px 10px 18px;}.lsd-text-field--medium{width:188px;}.lsd-text-field--medium>*{padding:6px 12px 6px 14px;}.lsd-text-field--small{width:164px;}.lsd-text-field--small>*{padding:6px 10px 6px 12px;}.lsd-text-field__label{padding-top:0;padding-bottom:6px;}.lsd-text-field__supporting-text{padding-bottom:0;padding-top:6px;}.lsd-text-field--outlined .lsd-text-field__input-container{border:1px solid rgb(var(--lsd-border-primary));}.lsd-text-field--underlined .lsd-text-field__input-container{border:1px solid transparent;border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-text-field__clear-button{padding:0;width:auto;height:auto;margin:0;border:0;}</style><style data-emotion="css-global uhig7c">.lsd-checkbox{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-checkbox__input{opacity:0;position:absolute;left:0;top:0;padding:0;margin:0;width:100%;height:100%;}.lsd-checkbox:not(.lsd-checkbox--disabled):hover,.lsd-checkbox:not(.lsd-checkbox--disabled).lsd-checkbox--focused{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-checkbox:not(.lsd-checkbox--disabled) .lsd-checkbox__input{cursor:pointer;}.lsd-checkbox--disabled{opacity:0.34;}.lsd-checkbox__label{margin-left:18px;}.lsd-checkbox--large .lsd-checkbox__label{margin-left:18px;}.lsd-checkbox--medium .lsd-checkbox__label{margin-left:14px;}.lsd-checkbox--small .lsd-checkbox__label{margin-left:12px;}</style><style data-emotion="css-global txommo">.lsd-autocomplete{box-sizing:border-box;}.lsd-autocomplete__label{display:block;}.lsd-autocomplete__input-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.lsd-autocomplete--disabled{opacity:0.34;}.lsd-autocomplete__input{border:none;outline:none;font-size:14px;color:rgb(var(--lsd-text-primary));background:none;width:100%;}.lsd-autocomplete__input:hover{outline:none;}.lsd-autocomplete__input::-webkit-input-placeholder{color:rgb(var(--lsd-text-primary));opacity:0.3;}.lsd-autocomplete__input::-moz-placeholder{color:rgb(var(--lsd-text-primary));opacity:0.3;}.lsd-autocomplete__input:-ms-input-placeholder{color:rgb(var(--lsd-text-primary));opacity:0.3;}.lsd-autocomplete__input::placeholder{color:rgb(var(--lsd-text-primary));opacity:0.3;}.lsd-autocomplete__icon{cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-autocomplete--error{-webkit-text-decoration:line-through;text-decoration:line-through;}.lsd-autocomplete--large{width:208px;}.lsd-autocomplete--large .lsd-autocomplete__label{margin:0 0 6px 18px;}.lsd-autocomplete--large .lsd-autocomplete__input-container{height:40px;}.lsd-autocomplete--large .lsd-autocomplete__input{padding:9px 17px;}.lsd-autocomplete--large .lsd-autocomplete__icon{padding:12px 13px;}.lsd-autocomplete--medium{width:188px;}.lsd-autocomplete--medium .lsd-autocomplete__label{margin:0 0 6px 14px;}.lsd-autocomplete--medium .lsd-autocomplete__input-container{height:32px;}.lsd-autocomplete--medium .lsd-autocomplete__input{padding:5px 13px;}.lsd-autocomplete--medium .lsd-autocomplete__icon{padding:8px 11px;}.lsd-autocomplete--small{width:164px;}.lsd-autocomplete--small .lsd-autocomplete__label{margin:0 0 6px 12px;}.lsd-autocomplete--small .lsd-autocomplete__input-container{height:28px;}.lsd-autocomplete--small .lsd-autocomplete__input{padding:5px 11px;}.lsd-autocomplete--small .lsd-autocomplete__icon{padding:6px 9px;}.lsd-autocomplete--outlined .lsd-autocomplete__input-container{border:1px solid rgb(var(--lsd-border-primary));}.lsd-autocomplete--underlined .lsd-autocomplete__input-container{border:1px solid transparent;border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-autocomplete__dropdown-item-placeholder{opacity:0.5;white-space:pre;}</style><style data-emotion="css-global quxxm6">.lsd-quote{color:rgb(var(--lsd-text-primary));white-space:pre-wrap;}.lsd-quote--indented-inline{border-left:1px solid rgb(var(--lsd-border-primary));padding:4px 8px 4px 28px;}.lsd-quote--parentheses{padding:0px;text-align:center;}.lsd-quote--parentheses::before{content:'***';}.lsd-quote--parentheses::after{content:'***';}</style><style data-emotion="css-global a49t4h">.lsd-collapse{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.lsd-collapse--open .lsd-collapse__content{border-top:1px solid transparent;}.lsd-collapse__content{border:1px solid rgb(var(--lsd-border-primary));}</style><style data-emotion="css-global 12ppw0q">.lsd-collapse-header{box-sizing:border-box;}.lsd-collapse-header:not(.lsd-collapse-header--disabled) .lsd-collapse-header__trigger:hover .lsd-collapse-header__label{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-collapse-header__trigger{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;cursor:pointer;background:none;border:1px solid rgb(var(--lsd-border-primary));}.lsd-collapse-header__trigger:focus{outline:none;}.lsd-collapse-header__label{cursor:inherit;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin:auto;}.lsd-collapse-header__icons{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;}.lsd-collapse-header__icon{margin-right:8px;}.lsd-collapse-header--disabled .lsd-collapse-header__trigger{opacity:0.34;cursor:initial;}.lsd-collapse-header--large .lsd-collapse-header__trigger{width:299px;height:40px;padding:9px 17px;}.lsd-collapse-header--medium .lsd-collapse-header__trigger{width:270px;height:32px;padding:5px 13px;}.lsd-collapse-header--small .lsd-collapse-header__trigger{width:235px;height:28px;padding:5px 11px;}</style><style data-emotion="css-global dixc0i">.lsd-checkbox-group{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:6px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;}.lsd-checkbox-group__label{margin-bottom:6px;}</style><style data-emotion="css-global q2n2hz">.lsd-badge{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;border:1px solid rgb(var(--lsd-icon-primary));border-radius:20px;}.lsd-badge:hover,.lsd-badge:focus{-webkit-text-decoration:underline;text-decoration:underline;cursor:pointer;}.lsd-badge--large{padding:3px 11px;gap:12px;height:28px;}.lsd-badge--small{padding:3px 7px;gap:8px;height:24px;}.lsd-badge--filled{background-color:rgb(var(--lsd-icon-primary));}.lsd-badge--filled .lsd-badge__label{color:rgb(var(--lsd-text-secondary));}.lsd-badge--filled svg{--lsd-icon-primary:var(--lsd-icon-secondary);}.lsd-badge--outlined{color:rgb(var(--lsd-text-primary));}.lsd-badge--disabled{opacity:0.3;cursor:initial;pointer-events:none;}</style><style data-emotion="css-global rlst54">.lsd-radio-button{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-radio-button__input{opacity:0;position:absolute;left:0;top:0;padding:0;margin:0;width:100%;height:100%;}.lsd-radio-button:not(.lsd-radio-button--disabled):hover{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-radio-button:not(.lsd-radio-button--disabled) .lsd-radio-button__input{cursor:pointer;}.lsd-radio-button--disabled{opacity:0.34;}.lsd-radio-button__label{margin-left:18px;}.lsd-radio-button--large .lsd-radio-button__label{margin-left:18px;}.lsd-radio-button--medium .lsd-radio-button__label{margin-left:14px;}.lsd-radio-button--small .lsd-radio-button__label{margin-left:12px;}</style><style data-emotion="css-global mo7h6o">.lsd-radio-button-group{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:6px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;}.lsd-radio-button-group__label{margin-bottom:6px;}</style><style data-emotion="css-global amncrr">.lsd-table{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.lsd-table>.lsd-table-header{margin-bottom:-1px;}</style><style data-emotion="css-global 1fkbozr">.lsd-table-header{box-sizing:border-box;border:1px solid rgb(var(--lsd-border-primary));}</style><style data-emotion="css-global 1fb1r54">.lsd-table-body table{border-collapse:collapse;text-align:center;table-layout:fixed;width:100%;height:auto;}.lsd-table-body table tr:first-of-type td label:has(input[type='radio']){display:none;}.lsd-table-body__toolbar{box-sizing:border-box;padding:10px;border:1px solid rgb(var(--lsd-border-primary));border-bottom:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><style data-emotion="css-global 607rj8">.lsd-table-item{border:1px solid rgb(var(--lsd-border-primary));}.lsd-table-item:has(> label){width:40px;}.lsd-table-item:has(> label) input{position:relative;width:14px;height:14px;margin:auto;}.lsd-table-item:has(> label) span{margin-left:14px!important;}.lsd-table-item--large{padding:10px;}.lsd-table-item--medium{padding:6px 8px;}.lsd-table-item--small{padding:6px;}</style><style data-emotion="css-global 1vlh57l">.lsd-table-row{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion="css-global 1fw5y3v">.lsd-number-input{width:auto;box-sizing:border-box;}.lsd-number-input__main-container:hover{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-number-input--error .lsd-number-input__main-container{-webkit-text-decoration:line-through;text-decoration:line-through;}.lsd-number-input__label{display:block;}.lsd-number-input__plus-minus-icons{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.lsd-number-input__input-container{box-sizing:border-box;border:1px solid rgb(var(--lsd-border-primary));border-left:0px;border-right:0px;}.lsd-number-input__error-icon{cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:10px 8px;}.lsd-number-input__input-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.lsd-number-input--disabled{opacity:0.34;}.lsd-number-input__main-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-number-input__input{border:none;outline:none;font-size:14px;color:rgb(var(--lsd-text-primary));background:none;text-align:center;padding:0 4px;}.lsd-number-input__input::-webkit-inner-spin-button{display:none;-webkit-appearance:none;}.lsd-number-input__input:hover{outline:none;}.lsd-number-input__supporting-text{position:absolute;}.lsd-number-input--large .lsd-number-input__label{margin:0 0 6px 18px;}.lsd-number-input--large .lsd-number-input__input-container{height:40px;}.lsd-number-input--large .lsd-number-input__input{width:62px;}.lsd-number-input--large .lsd-number-input__plus-minus-icons{height:40px;width:40px;}.lsd-number-input--large .lsd-number-input__supporting-text{margin:6px 18px 0 18px;}.lsd-number-input--medium .lsd-number-input__label{margin:0 0 6px 14px;}.lsd-number-input--medium .lsd-number-input__input-container{height:32px;}.lsd-number-input--medium .lsd-number-input__input{width:58px;}.lsd-number-input--medium .lsd-number-input__plus-minus-icons{height:32px;width:32px;}.lsd-number-input--medium .lsd-number-input__supporting-text{margin:6px 14px 0 14px;}.lsd-number-input--small .lsd-number-input__label{margin:0 0 6px 12px;}.lsd-number-input--small .lsd-number-input__input-container{height:28px;}.lsd-number-input--small .lsd-number-input__input{width:50px;}.lsd-number-input--small .lsd-number-input__plus-minus-icons{height:28px;width:28px;}.lsd-number-input--small .lsd-number-input__supporting-text{margin:6px 12px 0 12px;}</style><style data-emotion="css-global 12rmo7o">.lsd-modal{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0, 0, 0, 0.5);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:9999;}.lsd-modal__container{position:relative;background:rgb(var(--lsd-surface-primary));padding:20px;max-width:90%;box-sizing:border-box;border:1px solid rgb(var(--lsd-border-primary));}.lsd-modal__header{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-modal__close-icon{position:absolute;top:8px;right:8px;cursor:pointer;}.lsd-modal__title-and-subtitle-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.lsd-modal--large .lsd-modal__container{min-width:960px;}.lsd-modal--medium .lsd-modal__container{min-width:768px;}.lsd-modal--small .lsd-modal__container{min-width:614px;}.lsd-modal--extra-small .lsd-modal__container{min-width:490px;}</style><style data-emotion="css-global 1k7gzc">.lsd-modal-footer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><style data-emotion="css-global 1b9t8so">.lsd-modal-body{margin:18px 0;}</style><style data-emotion="css-global dyud2a">.lsd-date-picker{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;}.lsd-date-picker__calendar{border-top:none!important;}.lsd-date-picker--large .lsd-date-field--large{width:318px;}.lsd-date-picker--medium .lsd-date-field--medium{width:290px;}.lsd-date-picker--small .lsd-date-field--small{width:262px;}</style><style data-emotion="css-global olq3nk">.lsd-date-field{width:auto;box-sizing:border-box;}.lsd-date-field__label{display:block;}.lsd-date-field__input-container__icon{position:absolute;right:0;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgb(var(--lsd-surface-primary));}.lsd-date-field__input-container__icon:focus{background:blue;background-color:pink;border:1px solid rgb(var(--lsd-border-primary));}.lsd-date-field__input-container__no-icon{position:absolute;right:0;background-color:rgb(var(--lsd-surface-primary));padding:12px;}.lsd-date-field--outlined{border:1px solid rgb(var(--lsd-border-primary));}.lsd-date-field--underlined{border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-date-field__input-container{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.lsd-date-field--disabled{opacity:0.34;}.lsd-date-field__input-container__input{border:none;outline:none;font-size:14px;color:rgb(var(--lsd-text-primary));background:none;width:100%;opacity:0.4;-webkit-transition:opacity 0.2s ease-in-out;transition:opacity 0.2s ease-in-out;}.lsd-date-field__input-container__input::-webkit-inner-spin-button,.lsd-date-field__input-container__input::-webkit-calendar-picker-indicator{display:none;-webkit-appearance:none;}.lsd-date-field__input-container__input:hover{outline:none;}.lsd-date-field__supporting-text{position:absolute;}.lsd-date-field--large{width:208px;}.lsd-date-field--large .lsd-date-field__label{margin:0 0 6px 18px;}.lsd-date-field--large .lsd-date-field__input-container{height:40px;}.lsd-date-field--large .lsd-date-field__input-container__input{padding:9px 0px 9px 17px;}.lsd-date-field--large .lsd-date-field__input-container__icon{padding:12px 13px;}.lsd-date-field--large .lsd-date-field__supporting-text{margin:6px 18px 0 18px;}.lsd-date-field--medium{width:188px;}.lsd-date-field--medium .lsd-date-field__label{margin:0 0 6px 14px;}.lsd-date-field--medium .lsd-date-field__input-container{height:32px;}.lsd-date-field--medium .lsd-date-field__input-container__input{padding:5px 11px 5px 13px;}.lsd-date-field--medium .lsd-date-field__input-container__icon{padding:8px 11px;}.lsd-date-field--medium .lsd-date-field__supporting-text{margin:6px 14px 0 14px;}.lsd-date-field--small{width:164px;}.lsd-date-field--small .lsd-date-field__label{margin:0 0 6px 12px;}.lsd-date-field--small .lsd-date-field__input-container{height:28px;}.lsd-date-field--small .lsd-date-field__input-container__input{padding:5px 9px 5px 11px;font-size:12px;}.lsd-date-field--small .lsd-date-field__input-container__icon{padding:6px 9px;}.lsd-date-field--small .lsd-date-field__supporting-text{margin:6px 12px 0 12px;}.lsd-date-field__input-container__input:invalid,.lsd-date-field__input-container__input--filled{color:rgb(var(--lsd-border-primary));opacity:1;}.lsd-date-field--error .lsd-date-field__input-container__input::-webkit-datetime-edit-year-field,.lsd-date-field--error .lsd-date-field__input-container__input::-webkit-datetime-edit-month-field,.lsd-date-field--error .lsd-date-field__input-container__input::-webkit-datetime-edit-day-field{-webkit-text-decoration:line-through;text-decoration:line-through;}@supports not selector(::-webkit-datetime-edit-day-field){.lsd-date-field--error .lsd-date-field__input-container__input{-webkit-text-decoration:line-through;text-decoration:line-through;}}</style><style data-emotion="css-global 1gjtao4">.lsd-calendar{border:1px solid rgb(var(--lsd-border-primary));visibility:hidden;position:absolute!important;top:0;left:0;opacity:0;visibility:hidden;margin:0;padding:0;box-sizing:border-box;background:rgb(var(--lsd-surface-primary));-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.lsd-calendar-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:8px;}.lsd-calendar--open{opacity:1;visibility:visible;}.lsd-calendar-header{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:32px;margin-bottom:8px;}.lsd-calendar__week_day{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;aspect-ratio:1/1;margin-bottom:4px;}.lsd-calendar__change-year{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:2px 0xp 2px 8px;gap:6px;border:1px solid transparent;}.lsd-calendar__change-year--active .lsd-calendar__year-and-icon{border:1px solid rgb(var(--lsd-border-primary));}.lsd-calendar__change-year-icon-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;border:none;}.lsd-calendar-month{margin-right:8px;}.lsd-calendar__month-and-year{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}.lsd-calendar-day__container{cursor:pointer;background:transparent;position:relative;box-sizing:border-box;border:1px solid transparent;}.lsd-calendar-day{aspect-ratio:1/1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.lsd-calendar-day:hover{cursor:pointer;-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgb(var(--lsd-border-primary));}.lsd-calendar-day label:hover{cursor:pointer;}.lsd-calendar-day--selected{border:1px solid rgb(var(--lsd-border-primary));}.lsd-calendar-day--disabled{opacity:0.3;cursor:default;}.lsd-calendar-day__today_indicator{position:absolute;left:50%;-webkit-transform:translateX(-50%);-moz-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);bottom:2px;}.lsd-calendar--disabled{pointer-events:none;border:1px solid rgba(var(--lsd-border-primary), 0.3);}.lsd-calendar--disabled label{opacity:0.3;}.lsd-calendar--disabled .lsd-calendar__button{opacity:0.3;}.lsd-calendar--disabled .lsd-calendar-day--selected{opacity:0.3;}.lsd-calendar__button{border:1px solid rgb(var(--lsd-border-primary));cursor:pointer;background:transparent;width:32px;height:32px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:absolute;}.lsd-calendar__next-month-button{top:8px;right:8px;}.lsd-calendar__previous-month-button{top:8px;left:8px;}.lsd-calendar-day--border-left{border-left:1px double rgb(var(--lsd-border-primary));}.lsd-calendar-day--border-right{border-right:1px double rgb(var(--lsd-border-primary));}.lsd-calendar-day--border-left-and-right{border-left:1px double rgb(var(--lsd-border-primary));border-right:1px double rgb(var(--lsd-border-primary));}.lsd-calendar-day--border-top-and-bottom{border-top:1px double rgb(var(--lsd-border-primary));border-bottom:1px double rgb(var(--lsd-border-primary));}.lsd-calendar__month-table{border-collapse:collapse;}.lsd-calendar__year-dropdown{box-sizing:border-box;position:absolute;top:100%;left:0;max-height:200px;overflow-y:auto;width:100%;border:1px solid rgb(var(--lsd-border-primary));border-top:none;z-index:1;}.lsd-calendar__year-dropdown .lsd-calendar-year{border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-calendar__year-dropdown--hidden{visibility:hidden;}.lsd-calendar-year{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;cursor:pointer;-webkit-transition:background-color 0.2s;transition:background-color 0.2s;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:rgb(var(--lsd-surface-primary));}.lsd-calendar-year:hover{-webkit-text-decoration:underline;text-decoration:underline;}.lsd-calendar__year-and-icon{border:1px solid rgb(var(--lsd-border-primary));}.lsd-calendar--large .lsd-calendar-year{padding:6px 0px 6px 14px;}.lsd-calendar--large .lsd-calendar__change-year-icon-container{width:32px;}.lsd-calendar--medium .lsd-calendar-year{padding:6px 0px 6px 12px;}.lsd-calendar--medium .lsd-calendar__change-year-icon-container{width:28px;}.lsd-calendar--small .lsd-calendar-year{padding:6px 0px 6px 12px;}.lsd-calendar--small .lsd-calendar__change-year-icon-container{width:28px;}</style><style data-emotion="css-global dlrd7d">.lsd-toast{box-sizing:border-box;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:rgb(var(--lsd-surface-primary));border:1px solid rgb(var(--lsd-border-primary));padding:8px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;}.lsd-toast__inline-button-container{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}.lsd-toast__column-button-container{margin-top:18px;margin-bottom:6px;}.lsd-toast__inline-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}.lsd-toast__column-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.lsd-toast__text-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;color:rgb(var(--lsd-text-secondary));padding-left:12px;}.lsd-toast__title{position:relative;}.lsd-toast__information{margin-top:4px;}.lsd-toast__button-container{min-height:28px;min-width:60px;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;padding:0px 12px;}.lsd-toast__close-button{margin-bottom:auto;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:28px;width:28px;margin-left:auto;}.lsd-toast__column-icon-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;margin-bottom:auto;position:relative;top:4px;padding-left:4px;}.lsd-toast__inline-icon-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-left:4px;}.lsd-toast__icon{position:relative;}.lsd-toast--large{width:364px;}.lsd-toast--medium{width:336px;}.lsd-toast--small{width:296px;}.lsd-toast--small .lsd-toast__icon{top:0px;}</style><style data-emotion="css-global 5wlfwk">.lsd-toast-provider__toast-container{position:fixed;-webkit-transition:all 230ms cubic-bezier(0.21, 1.02, 0.73, 1);transition:all 230ms cubic-bezier(0.21, 1.02, 0.73, 1);z-index:9999;}.lsd-toast-provider__toast--top-left,.lsd-toast-provider__toast--top-center,.lsd-toast-provider__toast--top-right{top:0;}.lsd-toast-provider__toast--bottom-left,.lsd-toast-provider__toast--bottom-center,.lsd-toast-provider__toast--bottom-right{bottom:0;}.lsd-toast-provider__toast--top-center,.lsd-toast-provider__toast--bottom-center{left:50%;}.lsd-toast-provider__toast--top-right,.lsd-toast-provider__toast--bottom-right{right:0;}</style><style data-emotion="css-global 9yw6e1">.lsd-button-group{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.lsd-button-group >*:not(:last-child).lsd-button--outlined,.lsd-button-group >*:not(:last-child) .lsd-button--outlined{border-right:none;}</style><style data-emotion="css-global 17u9w7w">.lsd-date-range-picker{box-sizing:border-box;}.lsd-date-range-picker .lsd-date-field--outlined{border:none;}.lsd-date-range-picker .lsd-date-field__input-container__icon{padding:8px;}.lsd-date-range-picker__label{display:block;}.lsd-date-range-picker__input-container{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:1px solid transparent;}.lsd-date-picker__calendar{border-top:none!important;}.lsd-date-picker__calendar .lsd-tooltip-base__arrow-tip{-webkit-transition:left 0.2s ease-in-out;transition:left 0.2s ease-in-out;}.lsd-date-range-picker--calendar-open .lsd-date-range-picker__input-container{border-bottom:1px solid rgb(var(--lsd-border-primary));}.lsd-date-range-picker__icon{cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;padding:0 10px;}.lsd-date-range-picker--disabled{opacity:0.3;}.lsd-date-range-picker__supporting-text{position:absolute;}.lsd-date-range-picker--large{width:318px;}.lsd-date-range-picker--large .lsd-date-field--large{width:156px;}.lsd-date-range-picker--large .lsd-date-field__input-container__input{padding-right:0;}.lsd-date-range-picker--large .lsd-date-field__input-container__icon{padding:11px 12px;}.lsd-date-range-picker--large .lsd-date-range-picker__label{margin:0 0 6px 18px;}.lsd-date-range-picker--large .lsd-date-range-picker__input-container{height:40px;}.lsd-date-range-picker--large .lsd-date-range-picker__supporting-text{margin:6px 18px 0 18px;}.lsd-date-range-picker--medium{width:290px;}.lsd-date-range-picker--medium .lsd-date-field--medium{width:142px;}.lsd-date-range-picker--medium .lsd-date-field__input-container__input{padding-right:0;}.lsd-date-range-picker--medium .lsd-date-field__input-container__icon{padding:7px 8px;}.lsd-date-range-picker--medium .lsd-date-range-picker__label{margin:0 0 6px 14px;}.lsd-date-range-picker--medium .lsd-date-range-picker__input-container{height:32px;}.lsd-date-range-picker--medium .lsd-date-range-picker__supporting-text{margin:6px 14px 0 14px;}.lsd-date-range-picker--small{width:262px;}.lsd-date-range-picker--small .lsd-date-field--small{width:128px;}.lsd-date-range-picker--small .lsd-date-field__input-container__input{padding-right:0;}.lsd-date-range-picker--small .lsd-date-field__input-container__icon{padding:5px 7px;}.lsd-date-range-picker--small .lsd-date-range-picker__label{margin:0 0 6px 12px;}.lsd-date-range-picker--small .lsd-date-range-picker__input-container{height:28px;}.lsd-date-range-picker--small .lsd-date-range-picker__supporting-text{margin:6px 12px 0 12px;}.lsd-date-range-picker__separator{margin-left:3px;width:1px;height:100%;}.lsd-date-range-picker__separator{border-left:1px solid transparent;}.lsd-date-range-picker--outlined{border:1px solid rgb(var(--lsd-border-primary));}.lsd-date-range-picker--outlined .lsd-date-range-picker__separator{border-left:1px solid rgb(var(--lsd-border-primary));}</style><style data-emotion="css-global 19d282h">.lsd-tooltip-base{border:1px solid rgb(var(--lsd-border-primary));position:relative;}.lsd-tooltip-base__arrow-tip{border:1px solid rgb(var(--lsd-border-primary));position:absolute;background:rgb(var(--lsd-surface-primary));}.lsd-tooltip-base__content{background:rgb(var(--lsd-surface-primary));width:100%;height:100%;position:relative;z-index:1;}</style><style data-emotion="css-global js1ujt">html:not([data-theme]){--lsd-display1-fontSize:5.5rem;--lsd-display1-fontWeight:normal;--lsd-display1-lineHeight:6rem;--lsd-display2-fontSize:4rem;--lsd-display2-fontWeight:normal;--lsd-display2-lineHeight:4.5rem;--lsd-display3-fontSize:3.5rem;--lsd-display3-fontWeight:normal;--lsd-display3-lineHeight:4rem;--lsd-display4-fontSize:3rem;--lsd-display4-fontWeight:normal;--lsd-display4-lineHeight:3.5rem;--lsd-h1-fontSize:2.5rem;--lsd-h1-fontWeight:normal;--lsd-h1-lineHeight:3rem;--lsd-h2-fontSize:2rem;--lsd-h2-fontWeight:normal;--lsd-h2-lineHeight:2.5rem;--lsd-h3-fontSize:1.75rem;--lsd-h3-fontWeight:normal;--lsd-h3-lineHeight:2.25rem;--lsd-h4-fontSize:1.5rem;--lsd-h4-fontWeight:normal;--lsd-h4-lineHeight:2rem;--lsd-h5-fontSize:1.25rem;--lsd-h5-fontWeight:normal;--lsd-h5-lineHeight:1.75rem;--lsd-h6-fontSize:1rem;--lsd-h6-fontWeight:normal;--lsd-h6-lineHeight:1.5rem;--lsd-subtitle1-fontSize:1.125rem;--lsd-subtitle1-fontWeight:normal;--lsd-subtitle1-lineHeight:1.5rem;--lsd-subtitle2-fontSize:1rem;--lsd-subtitle2-fontWeight:normal;--lsd-subtitle2-lineHeight:1.5rem;--lsd-subtitle3-fontSize:0.875rem;--lsd-subtitle3-fontWeight:normal;--lsd-subtitle3-lineHeight:1.25rem;--lsd-subtitle4-fontSize:0.75rem;--lsd-subtitle4-fontWeight:normal;--lsd-subtitle4-lineHeight:1rem;--lsd-body1-fontSize:1rem;--lsd-body1-fontWeight:normal;--lsd-body1-lineHeight:1.5rem;--lsd-body2-fontSize:0.875rem;--lsd-body2-fontWeight:normal;--lsd-body2-lineHeight:1.25rem;--lsd-body3-fontSize:0.75rem;--lsd-body3-fontWeight:normal;--lsd-body3-lineHeight:1rem;--lsd-label1-fontSize:0.875rem;--lsd-label1-fontWeight:normal;--lsd-label1-lineHeight:1.25rem;--lsd-label2-fontSize:0.75rem;--lsd-label2-fontWeight:normal;--lsd-label2-lineHeight:1rem;--lsd-typography-generic-font-family:sans-serif;--lsd-theme-primary:0,0,0;--lsd-theme-secondary:255,255,255;--lsd-surface-primary:255,255,255;--lsd-surface-secondary:0,0,0;--lsd-border-primary:0,0,0;--lsd-border-secondary:255,255,255;--lsd-icon-primary:0,0,0;--lsd-icon-secondary:255,255,255;--lsd-text-primary:0,0,0;--lsd-text-secondary:255,255,255;--lsd-text-tertiary:0,0,0,0.34;--lsd-spacing-4:4px;--lsd-spacing-8:8px;--lsd-spacing-16:16px;--lsd-spacing-24:24px;--lsd-spacing-32:32px;--lsd-spacing-40:40px;--lsd-spacing-64:64px;--lsd-spacing-80:80px;--lsd-spacing-96:96px;--lsd-spacing-120:120px;}html[data-theme='light']{--lsd-display1-fontSize:5.5rem;--lsd-display1-fontWeight:normal;--lsd-display1-lineHeight:6rem;--lsd-display2-fontSize:4rem;--lsd-display2-fontWeight:normal;--lsd-display2-lineHeight:4.5rem;--lsd-display3-fontSize:3.5rem;--lsd-display3-fontWeight:normal;--lsd-display3-lineHeight:4rem;--lsd-display4-fontSize:3rem;--lsd-display4-fontWeight:normal;--lsd-display4-lineHeight:3.5rem;--lsd-h1-fontSize:2.5rem;--lsd-h1-fontWeight:normal;--lsd-h1-lineHeight:3rem;--lsd-h2-fontSize:2rem;--lsd-h2-fontWeight:normal;--lsd-h2-lineHeight:2.5rem;--lsd-h3-fontSize:1.75rem;--lsd-h3-fontWeight:normal;--lsd-h3-lineHeight:2.25rem;--lsd-h4-fontSize:1.5rem;--lsd-h4-fontWeight:normal;--lsd-h4-lineHeight:2rem;--lsd-h5-fontSize:1.25rem;--lsd-h5-fontWeight:normal;--lsd-h5-lineHeight:1.75rem;--lsd-h6-fontSize:1rem;--lsd-h6-fontWeight:normal;--lsd-h6-lineHeight:1.5rem;--lsd-subtitle1-fontSize:1.125rem;--lsd-subtitle1-fontWeight:normal;--lsd-subtitle1-lineHeight:1.5rem;--lsd-subtitle2-fontSize:1rem;--lsd-subtitle2-fontWeight:normal;--lsd-subtitle2-lineHeight:1.5rem;--lsd-subtitle3-fontSize:0.875rem;--lsd-subtitle3-fontWeight:normal;--lsd-subtitle3-lineHeight:1.25rem;--lsd-subtitle4-fontSize:0.75rem;--lsd-subtitle4-fontWeight:normal;--lsd-subtitle4-lineHeight:1rem;--lsd-body1-fontSize:1rem;--lsd-body1-fontWeight:normal;--lsd-body1-lineHeight:1.5rem;--lsd-body2-fontSize:0.875rem;--lsd-body2-fontWeight:normal;--lsd-body2-lineHeight:1.25rem;--lsd-body3-fontSize:0.75rem;--lsd-body3-fontWeight:normal;--lsd-body3-lineHeight:1rem;--lsd-label1-fontSize:0.875rem;--lsd-label1-fontWeight:normal;--lsd-label1-lineHeight:1.25rem;--lsd-label2-fontSize:0.75rem;--lsd-label2-fontWeight:normal;--lsd-label2-lineHeight:1rem;--lsd-typography-generic-font-family:sans-serif;--lsd-theme-primary:0,0,0;--lsd-theme-secondary:255,255,255;--lsd-surface-primary:255,255,255;--lsd-surface-secondary:0,0,0;--lsd-border-primary:0,0,0;--lsd-border-secondary:255,255,255;--lsd-icon-primary:0,0,0;--lsd-icon-secondary:255,255,255;--lsd-text-primary:0,0,0;--lsd-text-secondary:255,255,255;--lsd-text-tertiary:0,0,0,0.34;--lsd-spacing-4:4px;--lsd-spacing-8:8px;--lsd-spacing-16:16px;--lsd-spacing-24:24px;--lsd-spacing-32:32px;--lsd-spacing-40:40px;--lsd-spacing-64:64px;--lsd-spacing-80:80px;--lsd-spacing-96:96px;--lsd-spacing-120:120px;}html[data-theme='dark']{--lsd-display1-fontSize:5.5rem;--lsd-display1-fontWeight:normal;--lsd-display1-lineHeight:6rem;--lsd-display2-fontSize:4rem;--lsd-display2-fontWeight:normal;--lsd-display2-lineHeight:4.5rem;--lsd-display3-fontSize:3.5rem;--lsd-display3-fontWeight:normal;--lsd-display3-lineHeight:4rem;--lsd-display4-fontSize:3rem;--lsd-display4-fontWeight:normal;--lsd-display4-lineHeight:3.5rem;--lsd-h1-fontSize:2.5rem;--lsd-h1-fontWeight:normal;--lsd-h1-lineHeight:3rem;--lsd-h2-fontSize:2rem;--lsd-h2-fontWeight:normal;--lsd-h2-lineHeight:2.5rem;--lsd-h3-fontSize:1.75rem;--lsd-h3-fontWeight:normal;--lsd-h3-lineHeight:2.25rem;--lsd-h4-fontSize:1.5rem;--lsd-h4-fontWeight:normal;--lsd-h4-lineHeight:2rem;--lsd-h5-fontSize:1.25rem;--lsd-h5-fontWeight:normal;--lsd-h5-lineHeight:1.75rem;--lsd-h6-fontSize:1rem;--lsd-h6-fontWeight:normal;--lsd-h6-lineHeight:1.5rem;--lsd-subtitle1-fontSize:1.125rem;--lsd-subtitle1-fontWeight:normal;--lsd-subtitle1-lineHeight:1.5rem;--lsd-subtitle2-fontSize:1rem;--lsd-subtitle2-fontWeight:normal;--lsd-subtitle2-lineHeight:1.5rem;--lsd-subtitle3-fontSize:0.875rem;--lsd-subtitle3-fontWeight:normal;--lsd-subtitle3-lineHeight:1.25rem;--lsd-subtitle4-fontSize:0.75rem;--lsd-subtitle4-fontWeight:normal;--lsd-subtitle4-lineHeight:1rem;--lsd-body1-fontSize:1rem;--lsd-body1-fontWeight:normal;--lsd-body1-lineHeight:1.5rem;--lsd-body2-fontSize:0.875rem;--lsd-body2-fontWeight:normal;--lsd-body2-lineHeight:1.25rem;--lsd-body3-fontSize:0.75rem;--lsd-body3-fontWeight:normal;--lsd-body3-lineHeight:1rem;--lsd-label1-fontSize:0.875rem;--lsd-label1-fontWeight:normal;--lsd-label1-lineHeight:1.25rem;--lsd-label2-fontSize:0.75rem;--lsd-label2-fontWeight:normal;--lsd-label2-lineHeight:1rem;--lsd-typography-generic-font-family:sans-serif;--lsd-theme-primary:255,255,255;--lsd-theme-secondary:0,0,0;--lsd-surface-primary:0,0,0;--lsd-surface-secondary:255,255,255;--lsd-border-primary:255,255,255;--lsd-border-secondary:0,0,0;--lsd-icon-primary:255,255,255;--lsd-icon-secondary:0,0,0;--lsd-text-primary:255,255,255;--lsd-text-secondary:0,0,0;--lsd-text-tertiary:255,255,255,0.34;--lsd-spacing-4:4px;--lsd-spacing-8:8px;--lsd-spacing-16:16px;--lsd-spacing-24:24px;--lsd-spacing-32:32px;--lsd-spacing-40:40px;--lsd-spacing-64:64px;--lsd-spacing-80:80px;--lsd-spacing-96:96px;--lsd-spacing-120:120px;}</style><div class="root_QACb"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_OoEf"><div class="navbar__inner"><div class="navbar__left"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/theme/image/logo.svg" alt="Vac Research" class="themedImage_kfRS themedImage--light_BL8e" height="26"><img src="/theme/image/logo.svg" alt="Vac Research" class="themedImage_kfRS themedImage--dark_OvIx" height="26"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__left-items"></div><div class="navbar__right-items"><div class="iconButtonGroup_ktNv lsd-icon-button-group lsd-icon-button-group--medium lsd-icon-button-group--outlined"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_UEyd sidebarWithHideableNavbar__00c"><a tabindex="-1" class="sidebarLogo_Ydl9" href="/"><img src="/theme/image/logo.svg" alt="Vac Research" class="themedImage_kfRS themedImage--light_BL8e" height="26"><img src="/theme/image/logo.svg" alt="Vac Research" class="themedImage_kfRS themedImage--dark_OvIx" height="26"><b></b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_NjKY"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vac/">Vac RFCs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/vac/raw/"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" class="chevron_How5 lsd-icon lsd-icon--small lsd-icon--filled"><path d="M3.5 8.33875L4.3225 9.16125L7 6.48959L9.6775 9.16125L10.5 8.33875L7 4.83875L3.5 8.33875Z" fill="black"></path></svg><span class="lsd-typography lsd-typography--body2 lsd-typography--primary">Vac Raw Specifications</span></a><button aria-label="Toggle the collapsible sidebar category &#x27;Vac Raw Specifications&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vac/raw/decentralized-messaging-ethereum">VAC-DECENTRALIZED-MESSAGING-ETHEREUM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/vac/raw/eth-secpm">ETH-SECPM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vac/raw/gossipsub-tor-push">GOSSIPSUB-TOR-PUSH</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vac/raw/rln-interep-spec">RLN-INTEREP-SPEC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vac/raw/rln-stealth-commitments">RLN-STEALTH-COMMITMENTS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vac/raw/rln-v2">RLN-V2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vac/raw/url-scheme">STATUS-URL-SCHEME</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vac/1/coss">1/COSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vac/2/mvds">2/MVDS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vac/3/remote-log">3/REMOTE-LOG</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vac/4/mvds-meta">4/MVDS-META</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vac/25/libp2p-dns-discovery">25/LIBP2P-DNS-DISCOVERY</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vac/32/rln-v1">32/RLN-V1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vac/template">XX/(WAKU2|LOGOS|CODEX|*)-TEMPLATE</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row docItemGrid_SzoZ"><div class="docItemCol_F52z"><div class="docItemContainer_hrrU"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_RLvU" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><a class="breadcrumbs__item" href="/vac"><span class="lsd-typography lsd-typography--body3">Home</span></a><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/vac/raw/"><span class="lsd-typography lsd-typography--body3" itemprop="name">Vac Raw Specifications</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="lsd-typography lsd-typography--body3 breadcrumbs__link" itemprop="name">ETH-SECPM</span><meta itemprop="position" content="2"></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>ETH-SECPM</h1><div class="tocMobile_imaF"><div class="tocCollapsible_ROek theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_dxRj"><div></div><span class="lsd-typography lsd-typography--body2">On this page</span><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" class="lsd-icon lsd-icon--small lsd-icon--filled"><path d="M10.5 5.66125L9.6775 4.83875L7 7.51041L4.3225 4.83874L3.5 5.66125L7 9.16125L10.5 5.66125Z" fill="black"></path></svg></button></div></div></header><ul><li>Status: raw</li><li>Category: Standards Track</li><li>Editor: Ramses Fernandez &lt;<a href="mailto:ramses@status.im" target="_blank" rel="noopener noreferrer">ramses@status.im</a>&gt;</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="motivation">Motivation<a href="#motivation" class="hash-link" aria-label="Direct link to Motivation" title="Direct link to Motivation">​</a></h2><p>The need for secure communications has become paramount.
Traditional centralized messaging protocols are susceptible to various security threats,
including unauthorized access, data breaches, and single points of failure.
Therefore a decentralized approach to secure communication becomes increasingly relevant,
offering a robust solution to address these challenges.</p><p>This specification outlines a private messaging service using the Ethereum blockchain as authentication service.
Rooted in the existing <a href="/waku/standards/application/20/toy-eth-pm">model</a>,
this proposal addresses the deficiencies related to forward privacy and authentication inherent in the current framework.
The specification is divided into 3 sections:</p><ul><li>Private 1-to-1 communications protocol, based on <a href="https://signal.org/docs/specifications/doubleratchet/" target="_blank" rel="noopener noreferrer">Signal&#x27;s double ratchet</a>.</li><li>Private group messaging protocol, based on the <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">MLS protocol</a>.</li><li>Description of an Ethereum-based authentication protocol, based on <a href="https://eips.ethereum.org/EIPS/eip-4361" target="_blank" rel="noopener noreferrer">SIWE</a>.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="private-1-to-1-communications-protocol">Private 1-to-1 communications protocol<a href="#private-1-to-1-communications-protocol" class="hash-link" aria-label="Direct link to Private 1-to-1 communications protocol" title="Direct link to Private 1-to-1 communications protocol">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="theory">Theory<a href="#theory" class="hash-link" aria-label="Direct link to Theory" title="Direct link to Theory">​</a></h3><p>The specification is based on the noise protocol framework.
It corresponds to the double ratchet scheme combined with the X3DH algorithm, which will be used to initialize the former.
We chose to express the protocol in noise to be be able to use the noise streamlined implementation and proving features.
The X3DH algorithm provides both authentication and forward secrecy, as stated in the <a href="https://signal.org/docs/specifications/x3dh/" target="_blank" rel="noopener noreferrer">X3DH specification</a>.</p><p>This protocol will consist of several stages:</p><ol><li>Key setting for X3DH: this step will produce prekey bundles for Bob which will be fed into X3DH. It will also allow Alice to generate the keys required to run the X3DH algorithm correctly.</li><li>Execution of X3DH: This step will output a common secret key <code>SK</code> together with an additional data vector <code>AD</code>. Both will be used in the double ratchet algorithm initialization.</li><li>Execution of the double ratchet algorithm for forward secure, authenticated communications, using the common secret key <code>SK</code>, obtained from X3DH, as a root key.</li></ol><p>The protocol assumes the following requirements:</p><ul><li>Alice knows Bob’s Ethereum address.</li><li>Bob is willing to participate in the protocol, and publishes his public key.</li><li>Bob’s ownership of his public key is verifiable,</li><li>Alice wants to send message M to Bob.</li><li>An eavesdropper cannot read M’s content even if she is storing it or relaying it.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="syntax">Syntax<a href="#syntax" class="hash-link" aria-label="Direct link to Syntax" title="Direct link to Syntax">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cryptographic-suite">Cryptographic suite<a href="#cryptographic-suite" class="hash-link" aria-label="Direct link to Cryptographic suite" title="Direct link to Cryptographic suite">​</a></h4><p>The following cryptographic functions MUST be used:</p><ul><li><code>X488</code> as Diffie-Hellman function <code>DH</code>.</li><li><code>SHA256</code> as KDF.</li><li><code>AES256-GCM</code> as AEAD algorithm.</li><li><code>SHA512</code> as hash function.</li><li><code>XEd448</code> for digital signatures.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="x3dh-initialization">X3DH initialization<a href="#x3dh-initialization" class="hash-link" aria-label="Direct link to X3DH initialization" title="Direct link to X3DH initialization">​</a></h4><p>This scheme MUST work on the curve curve448.
The X3DH algorithm corresponds to the IX pattern in Noise.</p><p>Bob and Alice MUST define personal key pairs <code>(ik_B, IK_B)</code> and <code>(ik_A, IK_A)</code> respectively where:</p><ul><li>The key <code>ik</code> must be kept secret,</li><li>and the key <code>IK</code> is public.</li></ul><p>Bob MUST generate new keys using <code>(ik_B, IK_B) = GENERATE_KEYPAIR(curve = curve448)</code>.</p><p>Bob MUST also generate a public key pair <code>(spk_B, SPK_B) = GENERATE_KEYPAIR(curve = curve448)</code>.</p><p><code>SPK</code> is a public key generated and stored at medium-term.
Both signed prekey and the certificate MUST undergo periodic replacement.
After replacing the key,
Bob keeps the old private key of <code>SPK</code> for some interval, dependant on the implementation.
This allows Bob to decrypt delayed messages. </p><p>Bob MUST sign <code>SPK</code> for authentication: <code>SigSPK = XEd448(ik, Encode(SPK))</code></p><p>A final step requires the definition of <code>prekey_bundle = (IK, SPK, SigSPK, OPK_i)</code></p><p>One-time keys <code>OPK</code> MUST be generated as <code>(opk_B, OPK_B) = GENERATE_KEYPAIR(curve = curve448)</code>.</p><p>Before sending an initial message to Bob, Alice MUST generate an AD: <code>AD = Encode(IK_A) || Encode(IK_B)</code>.</p><p>Alice MUST generate ephemeral key pairs <code>(ek, EK) = GENERATE_KEYPAIR(curve = curve448)</code>.</p><p>The function <code>Encode()</code> transforms an curve448 public key into a byte sequence.
This is specified in the <a href="http://www.ietf.org/rfc/rfc7748.txt" target="_blank" rel="noopener noreferrer">RFC 7748</a> on elliptic curves for security.</p><p>One MUST consider <code>q = 2^446 - 13818066809895115352007386748515426880336692474882178609894547503885</code> for digital signatures with <code>(XEd448_sign, XEd448_verify)</code>:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">XEd448_sign((ik, IK), message):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Z = randbytes(64)  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    r = SHA512(2^456 - 2 || ik || message || Z )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    R = (r * convert_mont(5)) % q</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    h = SHA512(R || IK || M)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    s = (r + h * ik) % q</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return (R || s)</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">XEd448_verify(u, message, (R || s)):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (R.y &gt;= 2^448) or (s &gt;= 2^446): return FALSE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    h = (SHA512(R || 156326 || message)) % q</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    R_check = s * convert_mont(5) - h * 156326</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if R == R_check: return TRUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return FALSE </span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">convert_mont(u):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    u_masked = u % mod 2^448</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    inv = ((1 - u_masked)^(2^448 - 2^224 - 3)) % (2^448 - 2^224 - 1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    P.y = ((1 + u_masked) * inv)) % (2^448 - 2^224 - 1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    P.s = 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return P</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="use-of-x3dh">Use of X3DH<a href="#use-of-x3dh" class="hash-link" aria-label="Direct link to Use of X3DH" title="Direct link to Use of X3DH">​</a></h4><p>This specification combines the double ratchet with X3DH using the following data as initialization for the former:</p><ul><li>The <code>SK</code> output from X3DH becomes the <code>SK</code> input of the double ratchet. See section 3.3 of <a href="https://signal.org/docs/specifications/doubleratchet/" target="_blank" rel="noopener noreferrer">Signal Specification</a> for a detailed description.</li><li>The <code>AD</code> output from X3DH becomes the <code>AD</code> input of the double ratchet. See sections 3.4 and 3.5 of  <a href="https://signal.org/docs/specifications/doubleratchet/" target="_blank" rel="noopener noreferrer">Signal Specification</a>  for a detailed description.</li><li>Bob’s signed prekey <code>SigSPKB</code> from X3DH is used as Bob’s initial ratchet public key of the double ratchet.</li></ul><p>X3DH has three phases:</p><ol><li>Bob publishes his identity key and prekeys to a server, a network, or dedicated smart contract.</li><li>Alice fetches a prekey bundle from the server, and uses it to send an initial message to Bob.</li><li>Bob receives and processes Alice&#x27;s initial message.</li></ol><p>Alice MUST perform the following computations:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dh1 = DH(IK_A, SPK_B, curve = curve448)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dh2 = DH(EK_A, IK_B, curve = curve448)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dh3 = DH(EK_A, SPK_B)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SK = KDF(dh1 || dh2 || dh3)</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>Alice MUST send to Bob a message containing: </p><ul><li><code>IK_A, EK_A</code>.</li><li>An identifier to Bob&#x27;s prekeys used.</li><li>A message encrypted with AES256-GCM using <code>AD</code> and <code>SK</code>.</li></ul><p>Upon reception of the initial message, Bob MUST:</p><ol><li>Perform the same computations above with the <code>DH()</code> function.</li><li>Derive <code>SK</code> and construct <code>AD</code>.</li><li>Decrypt the initial message encrypted with <code>AES256-GCM</code>.</li><li>If decryption fails, abort the protocol.</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="initialization-of-the-double-datchet">Initialization of the double datchet<a href="#initialization-of-the-double-datchet" class="hash-link" aria-label="Direct link to Initialization of the double datchet" title="Direct link to Initialization of the double datchet">​</a></h4><p>In this stage Bob and Alice have generated key pairs and agreed a shared secret <code>SK</code> using X3DH.</p><p>Alice calls <code>RatchetInitAlice()</code> defined below:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">RatchetInitAlice(SK, IK_B):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.DHs = GENERATE_KEYPAIR(curve = curve448)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.DHr = IK_B</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.RK, state.CKs = HKDF(SK, DH(state.DHs, state.DHr)) </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.CKr = None</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.Ns, state.Nr, state.PN = 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.MKSKIPPED = {}</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>The HKDF function MUST be the proposal by <a href="http://www.ietf.org/rfc/rfc5869.txt" target="_blank" rel="noopener noreferrer">Krawczyk and Eronen</a>.
In this proposal <code>chaining_key</code> and <code>input_key_material</code> MUST be replaced with <code>SK</code> and the output of <code>DH</code> respectively.</p><p>Similarly, Bob calls the function <code>RatchetInitBob()</code> defined below:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">RatchetInitBob(SK, (ik_B,IK_B)):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.DHs = (ik_B, IK_B)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.Dhr = None</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.RK = SK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.CKs, state.CKr = None</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.Ns, state.Nr, state.PN = 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.MKSKIPPED = {}</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="encryption">Encryption<a href="#encryption" class="hash-link" aria-label="Direct link to Encryption" title="Direct link to Encryption">​</a></h4><p>This function performs the symmetric key ratchet.</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">RatchetEncrypt(state, plaintext, AD):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.CKs, mk = HMAC-SHA256(state.CKs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    header = HEADER(state.DHs, state.PN, state.Ns)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.Ns = state.Ns + 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return header, AES256-GCM_Enc(mk, plaintext, AD || header)</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>The <code>HEADER</code> function creates a new message header containing the public key from the key pair output of the <code>DH</code>function.<br>
It outputs the previous chain length <code>pn</code>, and the message number <code>n</code>.
The returned header object contains ratchet public key <code>dh</code> and integers <code>pn</code> and <code>n</code>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="decryption">Decryption<a href="#decryption" class="hash-link" aria-label="Direct link to Decryption" title="Direct link to Decryption">​</a></h4><p>The function <code>RatchetDecrypt()</code> decrypts incoming messages:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">RatchetDecrypt(state, header, ciphertext, AD):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    plaintext = TrySkippedMessageKeys(state, header, ciphertext, AD)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if plaintext != None:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return plaintext</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if header.dh != state.DHr:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        SkipMessageKeys(state, header.pn)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        DHRatchet(state, header)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    SkipMessageKeys(state, header.n)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.CKr, mk = HMAC-SHA256(state.CKr)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.Nr = state.Nr + 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return AES256-GCM_Dec(mk, ciphertext, AD || header)</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>Auxiliary functions follow:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">DHRatchet(state, header):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.PN = state.Ns</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.Ns = state.Nr = 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.DHr = header.dh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.RK, state.CKr = HKDF(state.RK, DH(state.DHs, state.DHr))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.DHs = GENERATE_KEYPAIR(curve = curve448)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    state.RK, state.CKs = HKDF(state.RK, DH(state.DHs, state.DHr))</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">SkipMessageKeys(state, until):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if state.NR + MAX_SKIP &lt; until:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        raise Error</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if state.CKr != none:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        while state.Nr &lt; until:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            state.CKr, mk = HMAC-SHA256(state.CKr)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            state.MKSKIPPED[state.DHr, state.Nr] = mk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            state.Nr = state.Nr + 1</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">TrySkippedMessageKey(state, header, ciphertext, AD):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (header.dh, header.n) in state.MKSKIPPED:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        mk = state.MKSKIPPED[header.dh, header.n]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        delete state.MKSKIPPED[header.dh, header.n]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return AES256-GCM_Dec(mk, ciphertext, AD || header)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else: return None</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="information-retrieval">Information retrieval<a href="#information-retrieval" class="hash-link" aria-label="Direct link to Information retrieval" title="Direct link to Information retrieval">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="static-data">Static data<a href="#static-data" class="hash-link" aria-label="Direct link to Static data" title="Direct link to Static data">​</a></h3><p>Some data, such as the key pairs <code>(ik, IK)</code> for Alice and Bob, MAY NOT be regenerated after a period of time.
Therefore the prekey bundle MAY be stored in long-term storage solutions, such as a dedicated smart contract which outputs such a key pair when receiving an Ethereum wallet address.</p><p>Storing static data is done using a dedicated smart contract <code>PublicKeyStorage</code> which associates the Ethereum wallet address of a user with his public key.
This mapping is done by <code>PublicKeyStorage</code> using a <code>publicKeys</code> function, or a <code>setPublicKey</code> function.
This mapping is done if the user passed an authorization process.
A user who wants to retrieve a public key associated with a specific wallet address calls a function <code>getPublicKey</code>.
The user provides the wallet address as the only input parameter for <code>getPublicKey</code>.
The function outputs the associated public key from the smart contract.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ephemeral-data">Ephemeral data<a href="#ephemeral-data" class="hash-link" aria-label="Direct link to Ephemeral data" title="Direct link to Ephemeral data">​</a></h3><p>Storing ephemeral data on Ethereum MAY be done using a combination of on-chain and off-chain solutions.
This approach provides an efficient solution to the problem of storing updatable data in Ethereum.</p><ol><li>Ethereum stores a reference or a hash that points to the off-chain data.</li><li>Off-chain solutions can include systems like IPFS, traditional cloud storage solutions, or decentralized storage networks such as a <a href="https://www.ethswarm.org" target="_blank" rel="noopener noreferrer">Swarm</a>.
In any case, the user stores the associated IPFS hash, URL or reference in Ethereum.</li></ol><p>The fact of a user not updating the ephemeral information can be understood as Bob not willing to participate in any communication.</p><p>This applies to <code>KeyPackage</code>, which in the MLS specification are meant to be stored in a directory provided by the delivery service.
If such an element does not exist, <code>KeyPackage</code> MUST be stored according to one of the two options outlined above.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="private-group-messaging-protocol">Private group messaging protocol<a href="#private-group-messaging-protocol" class="hash-link" aria-label="Direct link to Private group messaging protocol" title="Direct link to Private group messaging protocol">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="theory-1">Theory<a href="#theory-1" class="hash-link" aria-label="Direct link to Theory" title="Direct link to Theory">​</a></h3><p>The <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">Messaging Layer Security</a>(MLS) protocol aims at providing a group of users with end-to-end encryption in an authenticated and asynchronous way.
The main security characteristics of the protocol are: Message confidentiality and authentication, sender authentication,
membership agreement, post-remove and post-update security, and forward secrecy and post-compromise security.
The MLS protocol achieves: low-complexity, group integrity, synchronization and extensibility.</p><p>The extension to group chat described in forthcoming sections is built upon the <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">MLS</a> protocol.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="syntax-1">Syntax<a href="#syntax-1" class="hash-link" aria-label="Direct link to Syntax" title="Direct link to Syntax">​</a></h3><p>Each MLS session uses a single cipher suite that specifies the primitives to be used in group key computations. The cipher suite MUST use:</p><ul><li><code>X488</code> as Diffie-Hellman function.</li><li><code>SHA256</code> as KDF.</li><li><code>AES256-GCM</code> as AEAD algorithm.</li><li><code>SHA512</code> as hash function.</li><li><code>XEd448</code> for digital signatures.</li></ul><p>Formats for public keys, signatures and public-key encryption MUST follow Section 5.1 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hash-based-identifiers">Hash-based identifiers<a href="#hash-based-identifiers" class="hash-link" aria-label="Direct link to Hash-based identifiers" title="Direct link to Hash-based identifiers">​</a></h3><p>Some MLS messages refer to other MLS objects by hash.
These identifiers MUST be computed according to Section 5.2 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="credentials">Credentials<a href="#credentials" class="hash-link" aria-label="Direct link to Credentials" title="Direct link to Credentials">​</a></h3><p>Each member of a group presents a credential that provides one or more identities for the member and associates them with the member&#x27;s signing key.
The identities and signing key are verified by the Authentication Service in use for a group.</p><p>Credentials MUST follow the specifications of section 5.3 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><p>Below follows the flow diagram for the generation of credentials.
Users MUST generate key pairs by themselves.
</p><div class="wrapper_SWrM active_qZD5"><img loading="lazy" alt="figure1" src="/assets/images/eth-secpm_credential-ba3397173859f28e7269577e6258d18d.png" width="460" height="228" class="img_ev3q"><button class="fullscreenButton_Bocn lsd-icon-button lsd-icon-button--medium lsd-icon-button--outlined"><div class="icon_S7Kx m_thRi"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M1.75 2.917V5.25h1.167V2.917H5.25V1.75H2.917A1.17 1.17 0 0 0 1.75 2.917ZM2.917 8.75H1.75v2.333a1.17 1.17 0 0 0 1.167 1.167H5.25v-1.167H2.917V8.75Zm8.166 2.333H8.75v1.167h2.333a1.17 1.17 0 0 0 1.167-1.167V8.75h-1.167v2.333Zm0-9.333H8.75v1.167h2.333V5.25h1.167V2.917a1.17 1.17 0 0 0-1.167-1.167Z" fill="#fff"></path></svg></div></button></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="message-framing">Message framing<a href="#message-framing" class="hash-link" aria-label="Direct link to Message framing" title="Direct link to Message framing">​</a></h3><p>Handshake and application messages use a common framing structure providing encryption to ensure confidentiality within the group, and signing to authenticate the sender.</p><p>The structure is:</p><ul><li><code>PublicMessage</code>: represents a message that is only signed, and not encrypted.
The definition and the encoding/decoding of a <code>PublicMessage</code> MUST follow the specification in section 6.2 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</li><li><code>PrivateMessage</code>: represents a signed and encrypted message, with protections for both the content of the message and related metadata.
The definition, and the encoding/decoding of a <code>PrivateMessage</code> MUST follow the specification in section 6.3 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</li></ul><p>Applications MUST use <code>PrivateMessage</code> to encrypt application messages. </p><p>Applications SHOULD use <code>PrivateMessage</code> to encode handshake messages.</p><p>Each encrypted MLS message carries a &quot;generation&quot; number which is a per-sender incrementing counter.
If a group member observes a gap in the generation sequence for a sender,
then they know that they have missed a message from that sender.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nodes-contents">Nodes contents<a href="#nodes-contents" class="hash-link" aria-label="Direct link to Nodes contents" title="Direct link to Nodes contents">​</a></h3><p>The nodes of a ratchet tree contain several types of data:</p><ul><li>Leaf nodes describe individual members.</li><li>Parent nodes describe subgroups.</li></ul><p>Contents of each kind of node, and its structure MUST follow the indications described in sections 7.1 and 7.2 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="leaf-node-validation">Leaf node validation<a href="#leaf-node-validation" class="hash-link" aria-label="Direct link to Leaf node validation" title="Direct link to Leaf node validation">​</a></h3><p><code>KeyPackage</code> objects describe the client&#x27;s capabilities and provides keys that can be used to add the client to a group.</p><p>The validity of a leaf node needs to be verified at the following stages:</p><ul><li>When a leaf node is downloaded in a <code>KeyPackage</code>, before it is used to add the client to the group.</li><li>When a leaf node is received by a group member in an Add, Update, or Commit message.</li><li>When a client validates a ratchet tree.</li></ul><p>A client MUST verify the validity of a leaf node following the instructions of section 7.3 in <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ratchet-tree-evolution">Ratchet tree evolution<a href="#ratchet-tree-evolution" class="hash-link" aria-label="Direct link to Ratchet tree evolution" title="Direct link to Ratchet tree evolution">​</a></h3><p>Whenever a member initiates an epoch change, they MAY need to refresh the key pairs of their leaf and of the nodes on their direct path. This is done to keep forward secrecy and post-compromise security.
The member initiating the epoch change MUST follow this procedure procedure.
A member updates the nodes along its direct path as follows:</p><ul><li>Blank all the nodes on the direct path from the leaf to the root.</li><li>Generate a fresh HPKE key pair for the leaf.</li><li>Generate a sequence of path secrets, one for each node on the leaf&#x27;s filtered direct path.
It MUST follow the procedure described in section 7.4 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</li><li>Compute the sequence of HPKE key pairs <code>(node_priv,node_pub)</code>, one for each node on the leaf&#x27;s direct path.
It MUST follow the procedure described in section 7.4 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="views-of-the-tree-synchronization">Views of the tree synchronization<a href="#views-of-the-tree-synchronization" class="hash-link" aria-label="Direct link to Views of the tree synchronization" title="Direct link to Views of the tree synchronization">​</a></h3><p>After generating fresh key material and applying it to update their local tree state, the generator broadcasts this update to other members of the group.
This operation MUST be done according to section 7.5 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="leaf-synchronization">Leaf synchronization<a href="#leaf-synchronization" class="hash-link" aria-label="Direct link to Leaf synchronization" title="Direct link to Leaf synchronization">​</a></h3><p>Changes to group memberships MUST be represented by adding and removing leaves of the tree.
This corresponds to increasing or decreasing the depth of the tree, resulting in the number of leaves being doubled or halved.
These operations MUST be done as described in section 7.7 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tree-and-parent-hashing">Tree and parent hashing<a href="#tree-and-parent-hashing" class="hash-link" aria-label="Direct link to Tree and parent hashing" title="Direct link to Tree and parent hashing">​</a></h3><p>Group members can agree on the cryptographic state of the group by generating a hash value that represents the contents of the group ratchet tree and the member’s credentials.
The hash of the tree is the hash of its root node, defined recursively from the leaves.
Tree hashes summarize the state of a tree at point in time.
The hash of a leaf is the hash of the <code>LeafNodeHashInput</code> object.
At the same time, the hash of a parent node including the root, is the hash of a <code>ParentNodeHashInput</code> object.
Parent hashes capture information about how keys in the tree were populated.</p><p>Tree and parent hashing MUST follow the directions in Sections 7.8 and 7.9 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="key-schedule">Key schedule<a href="#key-schedule" class="hash-link" aria-label="Direct link to Key schedule" title="Direct link to Key schedule">​</a></h3><p>Group keys are derived using the <code>Extract</code> and <code>Expand</code> functions from the KDF for the group&#x27;s cipher suite, as well as the functions defined below:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExpandWithLabel(Secret, Label, Context, Length) = KDF.Expand(Secret, KDFLabel, Length)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DeriveSecret(Secret, Label) = ExpandWithLabel(Secret, Label, &quot;&quot;, KDF.Nh)</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p><code>KDFLabel</code> MUST be specified as:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    uint16 length;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    opaque label&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    opaque context&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">} KDFLabel;</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>The fields of <code>KDFLabel</code> MUST be:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">length = Length;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">label = &quot;MLS 1.0 &quot; + Label;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">context = Context;</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>Each member of the group MUST maintaint a <code>GroupContext</code> object summarizing the state of the group.
The sturcture of such object MUST be:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ProtocolVersion version = mls10;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CipherSuite cipher_suite;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">opaque group_id&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uint64 epoch;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">opaque tree_hash&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">opaque confirmed_trasncript_hash&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Extension extension&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">} GroupContext;</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>The use of key scheduling MUST follow the indications in sections 8.1 - 8.7 in <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="secret-trees">Secret trees<a href="#secret-trees" class="hash-link" aria-label="Direct link to Secret trees" title="Direct link to Secret trees">​</a></h3><p>For the generation of encryption keys and nonces, the key schedule begins with the <code>encryption_secret</code> at the root and derives a tree of secrets with the same structure as the group&#x27;s ratchet tree.
Each leaf in the secret tree is associated with the same group member as the corresponding leaf in the ratchet tree.</p><p>If <code>N</code> is a parent node in the secret tree, the secrets of the children of <code>N</code> MUST be defined following section 9 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="encryption-keys">Encryption keys<a href="#encryption-keys" class="hash-link" aria-label="Direct link to Encryption keys" title="Direct link to Encryption keys">​</a></h4><p>MLS encrypts three different types of information:</p><ul><li>Metadata (sender information).</li><li>Handshake messages (Proposal and Commit).</li><li>Application messages.</li></ul><p>For handshake and application messages, a sequence of keys is derived via a sender ratchet.
Each sender has their own sender ratchet, and each step along the ratchet is called a generation. These procedures MUST follow section 9.1 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="deletion-schedule">Deletion schedule<a href="#deletion-schedule" class="hash-link" aria-label="Direct link to Deletion schedule" title="Direct link to Deletion schedule">​</a></h4><p>All security-sensitive values MUST be deleted as soon as they are consumed.
A sensitive value S is consumed if:</p><ul><li>S was used to encrypt or (successfully) decrypt a message. </li><li>A key, nonce, or secret derived from S has been consumed.</li></ul><p>The deletion procedure MUST follow the instruction described in section 9.2 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="key-packages">Key packages<a href="#key-packages" class="hash-link" aria-label="Direct link to Key packages" title="Direct link to Key packages">​</a></h3><p>KeyPackage objects are used to ease the addition of clients to a group asynchronously.
A KeyPackage object specifies:</p><ul><li>Protocol version and cipher suite supported by the client.</li><li>Public keys that can be used to encrypt Welcome messages. Welcome messages provide new members with the information to initialize their state for the epoch in which they were added or in which they want to add themselves to the group</li><li>The content of the leaf node that should be added to the tree to represent this client.</li></ul><p>KeyPackages are intended to be used only once and SHOULD NOT be reused. </p><p>Clients MAY generate and publish multiple KeyPackages to support multiple cipher suites.</p><p>The structure of the object MUST be:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ProtocolVersion version;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CipherSuite cipher_suite;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HPKEPublicKey init_key;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LeafNode leaf_node;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Extension extensions&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/* SignWithLabel(., &quot;KeyPackageTBS&quot;, KeyPackageTBS) */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">opaque signature&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ProtocolVersion version;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CipheSuite cipher_suite;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HPKEPublicKey init_key;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LeafNode leaf_node;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Extension extensions&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p><code>KeyPackage</code> object MUST be verified when:</p><ul><li>A <code>KeyPackage</code> is downloaded by a group member, before it is used to add the client to the group.</li><li>When a <code>KeyPackage</code> is received by a group member in an <code>Add</code> message.</li></ul><p>Verification MUST be done as follows:</p><ul><li>Verify that the cipher suite and protocol version of the <code>KeyPackage</code> match those in the <code>GroupContext</code>.</li><li>Verify that the <code>leaf_node</code> of the <code>KeyPackage</code> is valid for a <code>KeyPackage</code>.</li><li>Verify that the signature on the <code>KeyPackage</code> is valid.</li><li>Verify that the value of <code>leaf_node.encryption_key</code> is different from the value of the <code>init_key field</code>.</li></ul><p>HPKE public keys are opaque values in a format defined by Section 4 of <a href="https://datatracker.ietf.org/doc/rfc9180/" target="_blank" rel="noopener noreferrer">RFC9180</a>.</p><p>Signature public keys are represented as opaque values in a format defined by the cipher suite&#x27;s signature scheme.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="group-creation">Group creation<a href="#group-creation" class="hash-link" aria-label="Direct link to Group creation" title="Direct link to Group creation">​</a></h3><p>A group is always created with a single member.
Other members are then added to the group using the usual Add/Commit mechanism.
The creator of a group MUST set:</p><ul><li>the group ID. </li><li>cipher suite.</li><li>initial extensions for the group. </li></ul><p>If the creator intends to add other members at the time of creation, then it SHOULD fetch <code>KeyPackages</code> for those members, and select a cipher suite and extensions according to their capabilities. </p><p>The creator MUST use the capabilities information in these <code>KeyPackages</code> to verify that the chosen version and cipher suite is the best option supported by all members.</p><p>Group IDs SHOULD be constructed so they are unique with high probability. </p><p>To initialize a group, the creator of the group MUST initialize a one-member group with the following initial values:</p><ul><li>Ratchet tree: A tree with a single node, a leaf node containing an HPKE public key and credential for the creator.</li><li>Group ID: A value set by the creator.</li><li>Epoch: <code>0</code>.</li><li>Tree hash: The root hash of the above ratchet tree.</li><li>Confirmed transcript hash: The zero-length octet string.</li><li>Epoch secret: A fresh random value of size <code>KDF.Nh</code>.</li><li>Extensions: Any values of the creator&#x27;s choosing.</li></ul><p>The creator MUST also calculate the interim transcript hash:</p><ul><li>Derive the <code>confirmation_key</code> for the epoch according to Section 8 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</li><li>Compute a <code>confirmation_tag</code> over the empty <code>confirmed_transcript_hash</code> using the <code>confirmation_key</code> as described in Section 8.1 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</li><li>Compute the updated <code>interim_transcript_hash</code> from the <code>confirmed_transcript_hash</code> and the <code>confirmation_tag</code> as described in Section 8.2 <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</li></ul><p>All members of a group MUST support the cipher suite and protocol version in use. Additional requirements MAY be imposed by including a <code>required_capabilities</code> extension in the <code>GroupContext</code>.</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExtensionType extension_types&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ProposalType proposal_types&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CredentialType credential_types&lt;V&gt;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>The flow diagram shows the procedure to fetch key material from other users:
</p><div class="wrapper_SWrM active_qZD5"><img loading="lazy" alt="figure2" src="/assets/images/eth-secpm_fetching-565512a6395769350b2c5b1274b3f69c.png" width="510" height="425" class="img_ev3q"><button class="fullscreenButton_Bocn lsd-icon-button lsd-icon-button--medium lsd-icon-button--outlined"><div class="icon_S7Kx m_thRi"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M1.75 2.917V5.25h1.167V2.917H5.25V1.75H2.917A1.17 1.17 0 0 0 1.75 2.917ZM2.917 8.75H1.75v2.333a1.17 1.17 0 0 0 1.167 1.167H5.25v-1.167H2.917V8.75Zm8.166 2.333H8.75v1.167h2.333a1.17 1.17 0 0 0 1.167-1.167V8.75h-1.167v2.333Zm0-9.333H8.75v1.167h2.333V5.25h1.167V2.917a1.17 1.17 0 0 0-1.167-1.167Z" fill="#fff"></path></svg></div></button></div><p></p><p>Below follows the flow diagram for the creation of a group:
</p><div class="wrapper_SWrM active_qZD5"><img loading="lazy" alt="figure3" src="/assets/images/eth-secpm_creation-e9f4d0d596ddd6c261508db853dd9b52.png" width="622" height="720" class="img_ev3q"><button class="fullscreenButton_Bocn lsd-icon-button lsd-icon-button--medium lsd-icon-button--outlined"><div class="icon_S7Kx m_thRi"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M1.75 2.917V5.25h1.167V2.917H5.25V1.75H2.917A1.17 1.17 0 0 0 1.75 2.917ZM2.917 8.75H1.75v2.333a1.17 1.17 0 0 0 1.167 1.167H5.25v-1.167H2.917V8.75Zm8.166 2.333H8.75v1.167h2.333a1.17 1.17 0 0 0 1.167-1.167V8.75h-1.167v2.333Zm0-9.333H8.75v1.167h2.333V5.25h1.167V2.917a1.17 1.17 0 0 0-1.167-1.167Z" fill="#fff"></path></svg></div></button></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="group-evolution">Group evolution<a href="#group-evolution" class="hash-link" aria-label="Direct link to Group evolution" title="Direct link to Group evolution">​</a></h3><p>Group membership can change, and existing members can change their keys in order to achieve post-compromise security.
In MLS, each such change is accomplished by a two-step process:</p><ul><li>A proposal to make the change is broadcast to the group in a Proposal message.</li><li>A member of the group or a new member broadcasts a Commit message that causes one or more proposed changes to enter into effect.</li></ul><p>The group evolves from one cryptographic state to another each time a Commit message is sent and processed.
These states are called epochs and are uniquely identified among states of the group by eight-octet epoch values. </p><p>Proposals are included in a <code>FramedContent</code> by way of a <code>Proposal</code> structure that indicates their type:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ProposalType proposal_type;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">select (Proposal.proposal_type) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case add:           Add:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case update:            Update;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case remove:            Remove;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case psk:           PreSharedKey;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case reinit:            ReInit;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case external_init:     ExternalInit;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case group_context_extensions:  GroupContextExtensions;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>On receiving a <code>FramedContent</code> containing a <code>Proposal</code>, a client MUST verify the signature inside <code>FramedContentAuthData</code> and that the epoch field of the enclosing FramedContent is equal to the epoch field of the current GroupContext object.
If the verification is successful, then the Proposal SHOULD be cached in such a way that it can be retrieved by hash in a later Commit message.</p><p>Proposals are organized as follows:</p><ul><li><code>Add</code>: requests that a client with a specified KeyPackage be added to the group.</li><li><code>Update</code>: similar to Add, it replaces the sender&#x27;s LeafNode in the tree instead of adding a new leaf to the tree.</li><li><code>Remove</code>: requests that the member with the leaf index removed be removed from the group.</li><li><code>ReInit</code>: requests to reinitialize the group with different parameters.</li><li><code>ExternalInit</code>: used by new members that want to join a group by using an external commit.</li><li><code>GroupContentExtensions</code>: it is used to update the list of extensions in the GroupContext for the group.</li></ul><p>Proposals structure and semantics MUST follow sections 12.1.1 - 12.1.7 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><p>Any list of commited proposals MUST be validated either by a the group member who created the commit, or any group member processing such commit.
The validation MUST be done according to one of the procedures described in Section 12.2 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><p>When creating or processing a Commit, a client applies a list of proposals to the ratchet tree and <code>GroupContext</code>.
The client MUST apply the proposals in the list in the order described in Section 12.3 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><p>Below follows the flow diagram for the addition of a member to a group:
</p><div class="wrapper_SWrM active_qZD5"><img loading="lazy" alt="figure4" src="/assets/images/eth-secpm_add-7a67a0d211cabceae702f2fe6a6bf778.png" width="586" height="769" class="img_ev3q"><button class="fullscreenButton_Bocn lsd-icon-button lsd-icon-button--medium lsd-icon-button--outlined"><div class="icon_S7Kx m_thRi"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M1.75 2.917V5.25h1.167V2.917H5.25V1.75H2.917A1.17 1.17 0 0 0 1.75 2.917ZM2.917 8.75H1.75v2.333a1.17 1.17 0 0 0 1.167 1.167H5.25v-1.167H2.917V8.75Zm8.166 2.333H8.75v1.167h2.333a1.17 1.17 0 0 0 1.167-1.167V8.75h-1.167v2.333Zm0-9.333H8.75v1.167h2.333V5.25h1.167V2.917a1.17 1.17 0 0 0-1.167-1.167Z" fill="#fff"></path></svg></div></button></div><p></p><p>The diagram below shows the procedure to remove a group member:
&lt;br/&gt;
</p><div class="wrapper_SWrM active_qZD5"><img loading="lazy" alt="figure5" src="/assets/images/eth-secpm_remove-05ff9ff9fe9a3c5b675343752e708dd4.png" width="622" height="425" class="img_ev3q"><button class="fullscreenButton_Bocn lsd-icon-button lsd-icon-button--medium lsd-icon-button--outlined"><div class="icon_S7Kx m_thRi"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M1.75 2.917V5.25h1.167V2.917H5.25V1.75H2.917A1.17 1.17 0 0 0 1.75 2.917ZM2.917 8.75H1.75v2.333a1.17 1.17 0 0 0 1.167 1.167H5.25v-1.167H2.917V8.75Zm8.166 2.333H8.75v1.167h2.333a1.17 1.17 0 0 0 1.167-1.167V8.75h-1.167v2.333Zm0-9.333H8.75v1.167h2.333V5.25h1.167V2.917a1.17 1.17 0 0 0-1.167-1.167Z" fill="#fff"></path></svg></div></button></div><p></p><p>The flow diagram below shows an update procedure:
&lt;br/&gt;
</p><div class="wrapper_SWrM active_qZD5"><img loading="lazy" alt="figure6" src="/assets/images/eth-secpm_update-5a67b9c8b3debf48af8380a9e4172540.png" width="463" height="622" class="img_ev3q"><button class="fullscreenButton_Bocn lsd-icon-button lsd-icon-button--medium lsd-icon-button--outlined"><div class="icon_S7Kx m_thRi"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M1.75 2.917V5.25h1.167V2.917H5.25V1.75H2.917A1.17 1.17 0 0 0 1.75 2.917ZM2.917 8.75H1.75v2.333a1.17 1.17 0 0 0 1.167 1.167H5.25v-1.167H2.917V8.75Zm8.166 2.333H8.75v1.167h2.333a1.17 1.17 0 0 0 1.167-1.167V8.75h-1.167v2.333Zm0-9.333H8.75v1.167h2.333V5.25h1.167V2.917a1.17 1.17 0 0 0-1.167-1.167Z" fill="#fff"></path></svg></div></button></div><p></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="commit-messages">Commit messages<a href="#commit-messages" class="hash-link" aria-label="Direct link to Commit messages" title="Direct link to Commit messages">​</a></h3><p>Commit messages initiate new group epochs.
It informs group members to update their representation of the state of the group by applying the proposals and advancing the key schedule.</p><p>Each proposal covered by the Commit is included by a <code>ProposalOrRef</code> value.
<code>ProposalOrRef</code> identify the proposal to be applied by value or by reference.
Commits that refer to new Proposals from the committer can be included by value.
Commits for previously sent proposals from anyone can be sent by reference.
Proposals sent by reference are specified by including the hash of the <code>AuthenticatedContent</code>.</p><p>Group members that have observed one or more valid proposals within an epoch MUST send a Commit message before sending application data.
A sender and a receiver of a Commit MUST verify that the committed list of proposals is valid.
The sender of a Commit SHOULD include all valid proposals received during the current epoch.</p><p>Functioning of commits MUST follow the instructions of Section 12.4 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="application-messages">Application messages<a href="#application-messages" class="hash-link" aria-label="Direct link to Application messages" title="Direct link to Application messages">​</a></h3><p>Handshake messages provide an authenticated group key exchange to clients.
To protect application messages sent among the members of a group, the <code>encryption_secret</code> provided by the key schedule is used to derive a sequence of nonces and keys for message encryption.</p><p>Each client MUST maintain their local copy of the key schedule for each epoch during which they are a group member.
They derive new keys, nonces, and secrets as needed. This data MUST be deleted as soon as they have been used.</p><p>Group members MUST use the AEAD algorithm associated with the negotiated MLS ciphersuite to encrypt and decrypt Application messages according to the Message Framing section.
The group identifier and epoch allow a device to know which group secrets should be used and from which Epoch secret to start computing other secrets and keys.
Application messages SHOULD be padded to provide resistance against traffic analysis techniques.
This avoids additional information to be provided to an attacker in order to guess the length of the encrypted message.
Padding SHOULD be used on messages with zero-valued bytes before AEAD encryption.</p><p>Functioning of application messages MUST follow the instructions of Section 15 of <a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">RFC9420</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="considerations-with-respect-to-decentralization">Considerations with respect to decentralization<a href="#considerations-with-respect-to-decentralization" class="hash-link" aria-label="Direct link to Considerations with respect to decentralization" title="Direct link to Considerations with respect to decentralization">​</a></h3><p>The MLS protocol assumes the existence on a (central, untrusted) <em>delivery service</em>, whose responsabilites include:</p><ul><li>Acting as a directory service providing the initial keying material for clients to use.</li><li>Routing MLS messages among clients.</li></ul><p>The central delivery service can be avoided in protocols using the publish/gossip approach, such as <a href="https://github.com/libp2p/specs/tree/master/pubsub/gossipsub" target="_blank" rel="noopener noreferrer">gossipsub</a>.</p><p>Concerning keys, each node can generate and disseminate their encryption key among the other nodes, so they can create a local version of the tree that allows for the generation of the group key.</p><p>Another important component is the <em>authentication service</em>, which is replaced with SIWE in this specification. </p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ethereum-based-authentication-protocol">Ethereum-based authentication protocol<a href="#ethereum-based-authentication-protocol" class="hash-link" aria-label="Direct link to Ethereum-based authentication protocol" title="Direct link to Ethereum-based authentication protocol">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="theory-2">Theory<a href="#theory-2" class="hash-link" aria-label="Direct link to Theory" title="Direct link to Theory">​</a></h3><p>Sign-in with Ethereum describes how Ethereum accounts authenticate with off-chain services by signing a standard message format
parameterized by scope, session details, and security mechanisms.
Sign-in with Ethereum (SIWE), which is described in the <a href="https://eips.ethereum.org/EIPS/eip-4361" target="_blank" rel="noopener noreferrer">EIP 4361</a>, MUST be the authentication method required. </p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="syntax-2">Syntax<a href="#syntax-2" class="hash-link" aria-label="Direct link to Syntax" title="Direct link to Syntax">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="message-format-abnf">Message format (ABNF)<a href="#message-format-abnf" class="hash-link" aria-label="Direct link to Message format (ABNF)" title="Direct link to Message format (ABNF)">​</a></h4><p>A SIWE Message MUST conform with the following Augmented Backus–Naur Form (<a href="https://datatracker.ietf.org/doc/html/rfc5234" target="_blank" rel="noopener noreferrer">RFC 5234</a>) expression.</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sign-in-with-ethereum =</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    [ scheme &quot;://&quot; ] domain %s&quot; wants you to sign in with your Ethereum account:&quot; LF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    address LF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    LF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    [ statement LF ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    LF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    %s&quot;URI: &quot; uri LF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    %s&quot;Version: &quot; version LF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    %s&quot;Chain ID: &quot; chain-id LF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    %s&quot;Nonce: &quot; nonce LF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    %s&quot;Issued At: &quot; issued-at</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    [ LF %s&quot;Expiration Time: &quot; expiration-time ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    [ LF %s&quot;Not Before: &quot; not-before ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    [ LF %s&quot;Request ID: &quot; request-id ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    [ LF %s&quot;Resources:&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    resources ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">scheme = ALPHA *( ALPHA / DIGIT / &quot;+&quot; / &quot;-&quot; / &quot;.&quot; )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; See RFC 3986 for the fully contextualized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; definition of &quot;scheme&quot;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">domain = authority</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; From RFC 3986:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ;     authority     = [ userinfo &quot;@&quot; ] host [ &quot;:&quot; port ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; See RFC 3986 for the fully contextualized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; definition of &quot;authority&quot;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">address = &quot;0x&quot; 40*40HEXDIG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; Must also conform to captilization</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; checksum encoding specified in EIP-55</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; where applicable (EOAs).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">statement = *( reserved / unreserved / &quot; &quot; )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; See RFC 3986 for the definition</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; of &quot;reserved&quot; and &quot;unreserved&quot;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; The purpose is to exclude LF (line break).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uri = URI</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; See RFC 3986 for the definition of &quot;URI&quot;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">version = &quot;1&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chain-id = 1*DIGIT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; See EIP-155 for valid CHAIN_IDs.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nonce = 8*( ALPHA / DIGIT )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; See RFC 5234 for the definition</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; of &quot;ALPHA&quot; and &quot;DIGIT&quot;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">issued-at = date-time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">expiration-time = date-time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">not-before = date-time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; See RFC 3339 (ISO 8601) for the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; definition of &quot;date-time&quot;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">request-id = *pchar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ; See RFC 3986 for the definition of &quot;pchar&quot;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resources = *( LF resource )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource = &quot;- &quot; URI</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>This specification defines the following SIWE Message fields that can be parsed from a SIWE Message by following the rules in ABNF Message Format:</p><ul><li><p><code>scheme</code> OPTIONAL. The URI scheme of the origin of the request.
Its value MUST be a <a href="https://datatracker.ietf.org/doc/html/rfc3986" target="_blank" rel="noopener noreferrer">RFC 3986</a> URI scheme.</p></li><li><p><code>domain</code> REQUIRED. The domain that is requesting the signing.
Its value MUST be a <a href="https://datatracker.ietf.org/doc/html/rfc3986" target="_blank" rel="noopener noreferrer">RFC 3986</a> authority. The authority includes an OPTIONAL port.
If the port is not specified, the default port for the provided scheme is assumed. </p></li></ul><p>If scheme is not specified, HTTPS is assumed by default.</p><ul><li><p><code>address</code> REQUIRED. The Ethereum address performing the signing.
Its value SHOULD be conformant to mixed-case checksum address encoding specified in ERC-55 where applicable.</p></li><li><p><code>statement</code> OPTIONAL. A human-readable ASCII assertion that the user will sign which MUST NOT include &#x27;\n&#x27; (the byte 0x0a).</p></li><li><p><code>uri</code> REQUIRED. An <a href="https://datatracker.ietf.org/doc/html/rfc3986" target="_blank" rel="noopener noreferrer">RFC 3986</a> URI referring to the resource that is the subject of the signing.</p></li><li><p><code>version</code> REQUIRED. The current version of the SIWE Message, which MUST be 1 for this specification.</p></li><li><p><code>chain-id</code> REQUIRED. The EIP-155 Chain ID to which the session is bound, and the network where Contract Accounts MUST be resolved.</p></li><li><p><code>nonce</code> REQUIRED. A random string (minimum 8 alphanumeric characters) chosen by the relying party and used to prevent replay attacks.</p></li><li><p><code>issued-at</code> REQUIRED. The time when the message was generated, typically the current time.
Its value MUST be an ISO 8601 datetime string.</p></li><li><p><code>expiration-time</code> OPTIONAL. The time when the signed authentication message is no longer valid.
Its value MUST be an ISO 8601 datetime string.</p></li><li><p><code>not-before</code> OPTIONAL. The time when the signed authentication message will become valid.
Its value MUST be an ISO 8601 datetime string.</p></li><li><p><code>request-id</code> OPTIONAL. An system-specific identifier that MAY be used to uniquely refer to the sign-in request.</p></li><li><p><code>resources</code> OPTIONAL. A list of information or references to information the user wishes to have resolved as part of authentication by the relying party.
Every resource MUST be a RFC 3986 URI separated by &quot;\n- &quot; where \n is the byte 0x0a.</p></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="signing-and-verifying-messages-with-ethereum-accounts">Signing and Verifying Messages with Ethereum Accounts<a href="#signing-and-verifying-messages-with-ethereum-accounts" class="hash-link" aria-label="Direct link to Signing and Verifying Messages with Ethereum Accounts" title="Direct link to Signing and Verifying Messages with Ethereum Accounts">​</a></h4><ul><li><p>For Externally Owned Accounts, the verification method specified in <a href="https://eips.ethereum.org/EIPS/eip-191" target="_blank" rel="noopener noreferrer">ERC-191</a> MUST be used.</p></li><li><p>For Contract Accounts,</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">- The verification method specified in [ERC-1271](https://eips.ethereum.org/EIPS/eip-1271) SHOULD be used. </span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>Otherwise, the implementer MUST clearly define the verification method to attain security and interoperability for both wallets and relying parties.</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">- When performing [ERC-1271](https://eips.ethereum.org/EIPS/eip-1271) signature verification, the contract performing the verification MUST be resolved from the specified `chain-id`.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- Implementers SHOULD take into consideration that [ERC-1271](https://eips.ethereum.org/EIPS/eip-1271) implementations are not required to be pure functions. </span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div><p>They can return different results for the same inputs depending on blockchain state.
This can affect the security model and session validation rules.</p></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="resolving-ethereum-name-service-ens-data">Resolving Ethereum Name Service (ENS) Data<a href="#resolving-ethereum-name-service-ens-data" class="hash-link" aria-label="Direct link to Resolving Ethereum Name Service (ENS) Data" title="Direct link to Resolving Ethereum Name Service (ENS) Data">​</a></h4><ul><li><p>The relying party or wallet MAY additionally perform resolution of ENS data, as this can improve the user experience by displaying human-friendly information that is related to the <code>address</code>.
Resolvable ENS data include:</p><div class="codeBlockContainer_EB2s codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:rgba(var(--lsd-surface-secondary), 0.08)"><div class="codeBlockContent_ugSV"><pre tabindex="0" class="prism-code language-text codeBlock_TWhw thin-scrollbar"><code class="codeBlockLines_LDrR"><span class="token-line" style="color:#F8F8F2"><span class="token plain">- The primary ENS name.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- The ENS avatar.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- Any other resolvable resources specified in the ENS documentation.</span><br></span></code></pre><div class="buttonGroup_Qu4e"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_an20" aria-hidden="true"><div class="icon_S7Kx m_thRi copyButtonIcon_ZL7v"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M2.917 12.833c-.321 0-.596-.114-.825-.343a1.121 1.121 0 0 1-.342-.823V3.5h1.167v8.167h6.416v1.166H2.917ZM5.25 10.5c-.32 0-.596-.114-.824-.343a1.121 1.121 0 0 1-.343-.824v-7c0-.32.115-.595.343-.824.229-.229.504-.343.824-.342h5.25c.32 0 .596.114.824.343.229.228.343.503.343.823v7c0 .321-.115.596-.343.825a1.121 1.121 0 0 1-.824.342H5.25Zm0-1.167h5.25v-7H5.25v7Z" fill="#fff"></path></svg></div></span></button></div></div></div></li><li><p>If resolution of ENS data is performed, implementers SHOULD take precautions to preserve user privacy and consent.
Their <code>address</code> could be forwarded to third party services as part of the resolution process.</p></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementer-steps-specifying-the-request-origin">Implementer steps: specifying the request origin<a href="#implementer-steps-specifying-the-request-origin" class="hash-link" aria-label="Direct link to Implementer steps: specifying the request origin" title="Direct link to Implementer steps: specifying the request origin">​</a></h4><p>The <code>domain</code> and, if present, the <code>scheme</code>, in the SIWE Message MUST correspond to the origin from where the signing request was made. </p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementer-steps-verifying-a-signed-message">Implementer steps: verifying a signed message<a href="#implementer-steps-verifying-a-signed-message" class="hash-link" aria-label="Direct link to Implementer steps: verifying a signed message" title="Direct link to Implementer steps: verifying a signed message">​</a></h4><p>The SIWE Message MUST be checked for conformance to the ABNF Message Format and its signature MUST be checked as defined in Signing and Verifying Messages with Ethereum Accounts.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementer-steps-creating-sessions">Implementer steps: creating sessions<a href="#implementer-steps-creating-sessions" class="hash-link" aria-label="Direct link to Implementer steps: creating sessions" title="Direct link to Implementer steps: creating sessions">​</a></h4><p>Sessions MUST be bound to the address and not to further resolved resources that can change.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementer-steps-interpreting-and-resolving-resources">Implementer steps: interpreting and resolving resources<a href="#implementer-steps-interpreting-and-resolving-resources" class="hash-link" aria-label="Direct link to Implementer steps: interpreting and resolving resources" title="Direct link to Implementer steps: interpreting and resolving resources">​</a></h4><p>Implementers SHOULD ensure that that URIs in the listed resources are human-friendly when expressed in plaintext form.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="wallet-implementer-steps-verifying-the-message-format">Wallet implementer steps: verifying the message format<a href="#wallet-implementer-steps-verifying-the-message-format" class="hash-link" aria-label="Direct link to Wallet implementer steps: verifying the message format" title="Direct link to Wallet implementer steps: verifying the message format">​</a></h4><p>The full SIWE message MUST be checked for conformance to the ABNF defined in ABNF Message Format.</p><p>Wallet implementers SHOULD warn users if the substring <code>&quot;wants you to sign in with your Ethereum account&quot;</code> appears anywhere in an <a href="https://eips.ethereum.org/EIPS/eip-191" target="_blank" rel="noopener noreferrer">ERC-191</a> message signing request unless the message fully conforms to the format defined ABNF Message Format.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="wallet-implementer-steps-verifying-the-request-origin">Wallet implementer steps: verifying the request origin<a href="#wallet-implementer-steps-verifying-the-request-origin" class="hash-link" aria-label="Direct link to Wallet implementer steps: verifying the request origin" title="Direct link to Wallet implementer steps: verifying the request origin">​</a></h4><p>Wallet implementers MUST prevent phishing attacks by verifying the origin of the request against the <code>scheme</code> and <code>domain</code> fields in the SIWE Message. </p><p>The origin SHOULD be read from a trusted data source such as the browser window or over WalletConnect <a href="https://eips.ethereum.org/EIPS/eip-1328" target="_blank" rel="noopener noreferrer">ERC-1328</a> sessions for comparison against the signing message contents.</p><p>Wallet implementers MAY warn instead of rejecting the verification if the origin is pointing to localhost.</p><p>The following is a RECOMMENDED algorithm for Wallets to conform with the requirements on request origin verification defined by this specification.</p><p>The algorithm takes the following input variables:</p><ul><li>fields from the SIWE message.</li><li><code>origin</code> of the signing request: the origin of the page which requested the signin via the provider.</li><li><code>allowedSchemes</code>: a list of schemes allowed by the Wallet.</li><li><code>defaultScheme</code>: a scheme to assume when none was provided. Wallet implementers in the browser SHOULD use https.</li><li>developer mode indication: a setting deciding if certain risks should be a warning instead of rejection. Can be manually configured or derived from <code>origin</code> being localhost.</li></ul><p>The algorithm is described as follows:</p><ul><li>If <code>scheme</code> was not provided, then assign <code>defaultScheme</code> as scheme.</li><li>If <code>scheme</code> is not contained in <code>allowedSchemes</code>, then the <code>scheme</code> is not expected and the Wallet MUST reject the request.
Wallet implementers in the browser SHOULD limit the list of allowedSchemes to just &#x27;https&#x27; unless a developer mode is activated.</li><li>If <code>scheme</code> does not match the scheme of origin, the Wallet SHOULD reject the request.
Wallet implementers MAY show a warning instead of rejecting the request if a developer mode is activated.
In that case the Wallet continues processing the request.</li><li>If the <code>host</code> part of the <code>domain</code> and <code>origin</code> do not match, the Wallet MUST reject the request unless the Wallet is in developer mode.
In developer mode the Wallet MAY show a warning instead and continues procesing the request.</li><li>If <code>domain</code> and <code>origin</code> have mismatching subdomains, the Wallet SHOULD reject the request unless the Wallet is in developer mode.
In developer mode the Wallet MAY show a warning instead and continues procesing the request.</li><li>Let <code>port</code> be the port component of <code>domain</code>, and if no port is contained in domain, assign port the default port specified for the scheme.</li><li>If <code>port</code> is not empty, then the Wallet SHOULD show a warning if the <code>port</code> does not match the port of <code>origin</code>.</li><li>If <code>port</code> is empty, then the Wallet MAY show a warning if <code>origin</code> contains a specific port.</li><li>Return request origin verification completed.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="wallet-implementer-steps-creating-siwe-interfaces">Wallet implementer steps: creating SIWE interfaces<a href="#wallet-implementer-steps-creating-siwe-interfaces" class="hash-link" aria-label="Direct link to Wallet implementer steps: creating SIWE interfaces" title="Direct link to Wallet implementer steps: creating SIWE interfaces">​</a></h4><p>Wallet implementers MUST display to the user the following fields from the SIWE Message request by default and prior to signing, if they are present: <code>scheme</code>, <code>domain</code>, <code>address</code>, <code>statement</code>, and <code>resources</code>.
Other present fields MUST also be made available to the user prior to signing either by default or through an extended interface.</p><p>Wallet implementers displaying a plaintext SIWE Message to the user SHOULD require the user to scroll to the bottom of the text area prior to signing.</p><p>Wallet implementers MAY construct a custom SIWE user interface by parsing the ABNF terms into data elements for use in the interface.
The display rules above still apply to custom interfaces.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="wallet-implementer-steps-supporting-internationalization-i18n">Wallet implementer steps: supporting internationalization (i18n)<a href="#wallet-implementer-steps-supporting-internationalization-i18n" class="hash-link" aria-label="Direct link to Wallet implementer steps: supporting internationalization (i18n)" title="Direct link to Wallet implementer steps: supporting internationalization (i18n)">​</a></h4><p>After successfully parsing the message into ABNF terms, translation MAY happen at the UX level per human language.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="privacy-and-security-considerations">Privacy and Security Considerations<a href="#privacy-and-security-considerations" class="hash-link" aria-label="Direct link to Privacy and Security Considerations" title="Direct link to Privacy and Security Considerations">​</a></h2><ul><li>The double ratchet &quot;recommends&quot; using AES in CBC mode. Since encryption must be with an AEAD encryption scheme, we will use AES in GCM mode instead (supported by Noise).</li><li>For the information retrieval, the algorithm MUST include a access control mechanisms to restrict who can call the set and get functions.</li><li>One SHOULD include event logs to track changes in public keys.</li><li>The curve vurve448 MUST be chosen due to its higher security level: 224-bit security instead of the 128-bit security provided by X25519.</li><li>It is important that Bob MUST NOT reuse <code>SPK</code>.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="considerations-related-to-the-use-of-ethereum-addresses">Considerations related to the use of Ethereum addresses<a href="#considerations-related-to-the-use-of-ethereum-addresses" class="hash-link" aria-label="Direct link to Considerations related to the use of Ethereum addresses" title="Direct link to Considerations related to the use of Ethereum addresses">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="with-respect-to-the-authentication-service">With respect to the Authentication Service<a href="#with-respect-to-the-authentication-service" class="hash-link" aria-label="Direct link to With respect to the Authentication Service" title="Direct link to With respect to the Authentication Service">​</a></h3><ul><li>If users used their Ethereum addresses as identifiers, they MUST generate their own credentials.
These credentials MUST use the digital signature key pair associated to the Ethereum address.</li><li>Other users can verify credentials.</li><li>With this approach, there is no need to have a dedicated Authentication Service responsible for the issuance and verification of credentials.</li><li>The interaction diagram showing the generation of credentials becomes obsolete.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="with-respect-to-the-delivery-service">With respect to the Delivery Service<a href="#with-respect-to-the-delivery-service" class="hash-link" aria-label="Direct link to With respect to the Delivery Service" title="Direct link to With respect to the Delivery Service">​</a></h3><ul><li>Users MUST generate their own KeyPackage.</li><li>Other users can verify KeyPackages when required.</li><li>A Delivery Service storage system MUST verify KeyPackages before storing them.</li><li>Interaction diagrams involving the DS do not change.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="copyright">Copyright<a href="#copyright" class="hash-link" aria-label="Direct link to Copyright" title="Direct link to Copyright">​</a></h2><p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="noopener noreferrer">CC0</a>.</p><h1>References</h1><div class="tocMobile_imaF"><div class="tocCollapsible_ROek theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_dxRj"><div></div><span class="lsd-typography lsd-typography--body2">On this page</span><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" class="lsd-icon lsd-icon--small lsd-icon--filled"><path d="M10.5 5.66125L9.6775 4.83875L7 7.51041L4.3225 4.83874L3.5 5.66125L7 9.16125L10.5 5.66125Z" fill="black"></path></svg></button></div></div><ul><li><a href="https://datatracker.ietf.org/doc/html/rfc5234" target="_blank" rel="noopener noreferrer">Augmented BNF for Syntax Specifications</a></li><li><a href="https://github.com/libp2p/specs/tree/master/pubsub/gossipsub" target="_blank" rel="noopener noreferrer">Gossipsub</a></li><li><a href="https://www.ietf.org/rfc/rfc5869.txt" target="_blank" rel="noopener noreferrer">HMAC-based Extract-and-Expand Key Derivation Function</a></li><li><a href="https://datatracker.ietf.org/doc/rfc9180/" target="_blank" rel="noopener noreferrer">Hybrid Public Key Encryption</a></li><li><a href="https://eprint.iacr.org/2019/1189.pdf" target="_blank" rel="noopener noreferrer">Security Analysis and Improvements for the IETF MLS Standard for Group Messaging</a></li><li><a href="https://eips.ethereum.org/EIPS/eip-191" target="_blank" rel="noopener noreferrer">Signed Data Standard</a></li><li><a href="https://eips.ethereum.org/EIPS/eip-4361" target="_blank" rel="noopener noreferrer">Sign-In with Ethereum</a></li><li><a href="https://eips.ethereum.org/EIPS/eip-1271" target="_blank" rel="noopener noreferrer">Standard Signature Validation Method for Contracts</a></li><li><a href="https://signal.org/docs/specifications/doubleratchet/" target="_blank" rel="noopener noreferrer">The Double Ratchet Algorithm</a></li><li><a href="https://datatracker.ietf.org/doc/rfc9420/" target="_blank" rel="noopener noreferrer">The Messaging Layer Security Protocol</a></li><li><a href="https://signal.org/docs/specifications/x3dh/" target="_blank" rel="noopener noreferrer">The X3DH Key Agreement Protocol</a></li><li><a href="https://rfc.vac.dev/spec/20/" target="_blank" rel="noopener noreferrer">Toy Ethereum Private Messaging Protocol</a></li><li><a href="https://datatracker.ietf.org/doc/html/rfc3986" target="_blank" rel="noopener noreferrer">Uniform Resource Identifier</a></li><li><a href="https://eips.ethereum.org/EIPS/eip-1328" target="_blank" rel="noopener noreferrer">WalletConnect URI Format</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/vac/raw/decentralized-messaging-ethereum"><div class="icon_S7Kx m_thRi"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="M11.667 6.417h-7.1l3.261-3.261L7 2.333 2.333 7 7 11.667l.823-.823-3.255-3.26h7.099V6.417Z" fill="#fff"></path></svg></div><span class="lsd-typography lsd-typography--body2 pagination-nav__label">VAC-DECENTRALIZED-MESSAGING-ETHEREUM</span></a><a class="pagination-nav__link pagination-nav__link--next" href="/vac/raw/gossipsub-tor-push"><span class="lsd-typography lsd-typography--body2 pagination-nav__label">GOSSIPSUB-TOR-PUSH</span><div class="icon_S7Kx m_thRi"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path d="m7 2.333-.823.823 3.255 3.26H2.333v1.167h7.1l-3.256 3.261.823.823L11.667 7 7 2.333Z" fill="#fff"></path></svg></div></a></nav></div></div><div class="gap1_XuuQ"></div><div class="toc_pP_5"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#motivation" class="table-of-contents__link toc-highlight">Motivation</a></li><li><a href="#private-1-to-1-communications-protocol" class="table-of-contents__link toc-highlight">Private 1-to-1 communications protocol</a><ul><li><a href="#theory" class="table-of-contents__link toc-highlight">Theory</a></li><li><a href="#syntax" class="table-of-contents__link toc-highlight">Syntax</a></li></ul></li><li><a href="#information-retrieval" class="table-of-contents__link toc-highlight">Information retrieval</a><ul><li><a href="#static-data" class="table-of-contents__link toc-highlight">Static data</a></li><li><a href="#ephemeral-data" class="table-of-contents__link toc-highlight">Ephemeral data</a></li></ul></li><li><a href="#private-group-messaging-protocol" class="table-of-contents__link toc-highlight">Private group messaging protocol</a><ul><li><a href="#theory-1" class="table-of-contents__link toc-highlight">Theory</a></li><li><a href="#syntax-1" class="table-of-contents__link toc-highlight">Syntax</a></li><li><a href="#hash-based-identifiers" class="table-of-contents__link toc-highlight">Hash-based identifiers</a></li><li><a href="#credentials" class="table-of-contents__link toc-highlight">Credentials</a></li><li><a href="#message-framing" class="table-of-contents__link toc-highlight">Message framing</a></li><li><a href="#nodes-contents" class="table-of-contents__link toc-highlight">Nodes contents</a></li><li><a href="#leaf-node-validation" class="table-of-contents__link toc-highlight">Leaf node validation</a></li><li><a href="#ratchet-tree-evolution" class="table-of-contents__link toc-highlight">Ratchet tree evolution</a></li><li><a href="#views-of-the-tree-synchronization" class="table-of-contents__link toc-highlight">Views of the tree synchronization</a></li><li><a href="#leaf-synchronization" class="table-of-contents__link toc-highlight">Leaf synchronization</a></li><li><a href="#tree-and-parent-hashing" class="table-of-contents__link toc-highlight">Tree and parent hashing</a></li><li><a href="#key-schedule" class="table-of-contents__link toc-highlight">Key schedule</a></li><li><a href="#secret-trees" class="table-of-contents__link toc-highlight">Secret trees</a></li><li><a href="#key-packages" class="table-of-contents__link toc-highlight">Key packages</a></li><li><a href="#group-creation" class="table-of-contents__link toc-highlight">Group creation</a></li><li><a href="#group-evolution" class="table-of-contents__link toc-highlight">Group evolution</a></li><li><a href="#commit-messages" class="table-of-contents__link toc-highlight">Commit messages</a></li><li><a href="#application-messages" class="table-of-contents__link toc-highlight">Application messages</a></li><li><a href="#considerations-with-respect-to-decentralization" class="table-of-contents__link toc-highlight">Considerations with respect to decentralization</a></li></ul></li><li><a href="#ethereum-based-authentication-protocol" class="table-of-contents__link toc-highlight">Ethereum-based authentication protocol</a><ul><li><a href="#theory-2" class="table-of-contents__link toc-highlight">Theory</a></li><li><a href="#syntax-2" class="table-of-contents__link toc-highlight">Syntax</a></li></ul></li><li><a href="#privacy-and-security-considerations" class="table-of-contents__link toc-highlight">Privacy and Security Considerations</a></li><li><a href="#considerations-related-to-the-use-of-ethereum-addresses" class="table-of-contents__link toc-highlight">Considerations related to the use of Ethereum addresses</a><ul><li><a href="#with-respect-to-the-authentication-service" class="table-of-contents__link toc-highlight">With respect to the Authentication Service</a></li><li><a href="#with-respect-to-the-delivery-service" class="table-of-contents__link toc-highlight">With respect to the Delivery Service</a></li></ul></li><li><a href="#copyright" class="table-of-contents__link toc-highlight">Copyright</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid firstRow_ar1q"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/theme/image/logo.svg" alt="Vac Research" class="themedImage_kfRS themedImage--light_BL8e footer__logo" width="22"><img src="/theme/image/logo.svg" alt="Vac Research" class="themedImage_kfRS themedImage--dark_OvIx footer__logo" width="22"></a></div><div class="footer__copyright">Codex @2023<br>All Rights Reserved.</div></div><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/Codex_storage" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/2NXGrsqmDq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li><li class="footer__item"><a href="https://github.com/codex-storage" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Contact us</a></li><li class="footer__item"><a href="https://jobs.status.im/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Work with us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/terms">Terms &amp; conditions</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-policy">Privacy Policy</a></li><li class="footer__item"><a class="footer__link-item" href="/security">Security</a></li></ul></div></div></div><div class="secondRow__ww3"><span class="footer__bottom text--center">Built by <a href="https://free.technology/" target="_blank" class="footerLink_sh7M">IFT</a></span><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Research</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://vac.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">VacP2P<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://afaik.institute" target="_blank" rel="noopener noreferrer" class="footer__link-item">AFAIK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Infrastructure</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://waku.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Waku<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://nimbus.team/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Nimbus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://codex.storage" target="_blank" rel="noopener noreferrer" class="footer__link-item">Codex<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://nomos.tech" target="_blank" rel="noopener noreferrer" class="footer__link-item">Nomos<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Creative Studio</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://acid.info" target="_blank" rel="noopener noreferrer" class="footer__link-item">Acid.info<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Movement</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://logos.co" target="_blank" rel="noopener noreferrer" class="footer__link-item">Logos<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">User-facing products</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://status.im" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://keycard.tech" target="_blank" rel="noopener noreferrer" class="footer__link-item">Keycard<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div><button class="backToTop_wDfN lsd-button lsd-button--small lsd-button--outlined"><span class="lsd-typography lsd-typography--label2 lsd-button__text">Back to top ↑</span></button></footer></div></div>
<script src="/assets/js/runtime~main.3dffa60e.js"></script>
<script src="/assets/js/main.ecc006a1.js"></script>
</body>
</html>